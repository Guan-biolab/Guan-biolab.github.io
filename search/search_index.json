{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#the-guan-team","title":"The Guan Team","text":"<p>2024.7.24</p> <p>Welcome to Guan Team!</p>"},{"location":"#_1","title":"\u751f\u7269\u4fe1\u606f\u5b66\u5e73\u53f0/\u5b9e\u9a8c\u5ba4","text":""},{"location":"#_2","title":"\u7b80\u4ecb","text":"<p>\u200b        \u751f\u7269\u4fe1\u606f\u5b66\u5e73\u53f0/\u5b9e\u9a8c\u5ba4\u7531\u5409\u6797\u5927\u5b66\u7b2c\u4e00\u533b\u9662\u8f6c\u5316\u533b\u5b66\u7814\u7a76\u9662\u521b\u5efa\u4e8e2022\u5e749\u6708\uff0c\u65e8\u5728\u5229\u7528\u5148\u8fdb\u7684\u751f\u7269\u4fe1\u606f\u5b66\u6280\u672f\u548c\u65b9\u6cd5\uff0c\u52a0\u901f\u533b\u5b66\u7814\u7a76\u7684\u8f6c\u5316\u5e94\u7528\u3002\u8be5\u5e73\u53f0\u81f4\u529b\u4e8e\u6574\u5408\u4e34\u5e8a\u6570\u636e\u4e0e\u751f\u7269\u5927\u6570\u636e\uff0c\u901a\u8fc7\u6df1\u5ea6\u6570\u636e\u5206\u6790\u548c\u751f\u7269\u4fe1\u606f\u5b66\u5de5\u5177\u7684\u5f00\u53d1\uff0c\u652f\u6301\u75be\u75c5\u673a\u7406\u7814\u7a76\u3001\u65b0\u836f\u5f00\u53d1\u3001\u7cbe\u51c6\u533b\u7597\u548c\u4e2a\u6027\u5316\u6cbb\u7597\u7b56\u7565\u7684\u5236\u5b9a\u3002</p> <p>\u200b       \u5e73\u53f0\u5b9a\u4f4d\u4e8e\u4fc3\u8fdb\u751f\u7269\u533b\u5b66\u6570\u636e\u7684\u9ad8\u6548\u7ba1\u7406\u548c\u5229\u7528\uff0c\u52a0\u5f3a\u8de8\u5b66\u79d1\u5408\u4f5c\uff0c\u63a8\u52a8\u533b\u5b66\u7814\u7a76\u4e0e\u4e34\u5e8a\u5b9e\u8df5\u7684\u7d27\u5bc6\u7ed3\u5408\uff0c\u6700\u7ec8\u4e3a\u63d0\u9ad8\u60a3\u8005\u6cbb\u7597\u6548\u679c\u548c\u751f\u6d3b\u8d28\u91cf\u505a\u51fa\u8d21\u732e\u3002\u901a\u8fc7\u63d0\u4f9b\u4e13\u4e1a\u7684\u751f\u7269\u4fe1\u606f\u5b66\u670d\u52a1\u548c\u57f9\u8bad\uff0c\u57f9\u517b\u4e00\u6279\u5177\u6709\u9ad8\u7ea7\u751f\u7269\u4fe1\u606f\u5b66\u5206\u6790\u80fd\u529b\u7684\u7814\u7a76\u4eba\u624d\uff0c\u6ee1\u8db3\u9662\u5185\u751f\u7269\u4fe1\u606f\u5b66\u670d\u52a1\u9700\u6c42\uff0c\u540c\u65f6\u4e3a\u56fd\u5185\u5916\u751f\u7269\u533b\u5b66\u7814\u7a76\u9886\u57df\u8f93\u9001\u65b0\u9c9c\u8840\u6db2\u3002</p> <p></p>"},{"location":"#pi","title":"PI \u7b80\u4ecb","text":"<p>\u7ba1\u9752\u5929 \u535a\u58eb\u751f\u5bfc\u5e08</p> <p>\u200b         2021\u5e74\u83b7\u5f97\u963f\u535c\u675c\u62c9\u56fd\u738b\u79d1\u6280\u5927\u5b66\uff08King Abdullah University of Science and Technology\uff09\u751f\u547d\u79d1\u5b66\u535a\u58eb\u5b66\u4f4d\uff0c\u53c2\u4e0e\u5e76\u8d1f\u8d23King Abdulaziz City for Science and Technology\uff08KACST\uff09\u5b50\u9879\u76ee\u4e00\u9879\uff1b\u5148\u540e\u5728Emerging Infectious Diseases, Journal of Travel Medicine, NAR Genomics and Bioinformatics\u7b49\u6742\u5fd7\u53d1\u8868\u5b66\u672f\u8bba\u658720\u4f59\u7bc7\u3002</p> <p>2022\u5e74\u4eba\u624d\u5f15\u8fdb\u5409\u6797\u5927\u5b66\u7b2c\u4e00\u533b\u9662\u8f6c\u5316\u533b\u5b66\u7814\u7a76\u9662\uff0c\u7ec4\u5efa\u5409\u6797\u5927\u5b66\u7b2c\u4e00\u533b\u9662\u751f\u7269\u4fe1\u606f\u5b66\u5b9e\u9a8c\u5ba4\u3002 \u4e3b\u8981\u4ece\u4e8b\u75c5\u539f\u5fae\u751f\u7269\u57fa\u56e0\u7ec4\u5206\u6790\u3001\u5b8f\u57fa\u56e0\u7ec4\u5b66\u533b\u7597\u8bca\u65ad\u5de5\u4f5c\u3002</p>"},{"location":"#_3","title":"\u5b9e\u9a8c\u5ba4\u65b0\u95fb","text":""},{"location":"news/","title":"News","text":""},{"location":"news/#the-guan-team","title":"The Guan Team","text":"<p>2024.7.24</p> <p>Welcome to Guan Team!</p>"},{"location":"news/#_1","title":"\u5b9e\u9a8c\u5ba4\u65b0\u95fb","text":""},{"location":"people/","title":"People","text":""},{"location":"people/#the-guan-team","title":"The Guan Team","text":"<p>2024.7.24</p> <p>Welcome to Guan Team!</p>"},{"location":"people/#_1","title":"\u751f\u7269\u4fe1\u606f\u5b66\u5e73\u53f0/\u5b9e\u9a8c\u5ba4","text":""},{"location":"publications/","title":"Publications","text":""},{"location":"publications/#the-guan-team","title":"The Guan Team","text":"<p>2024.7.24</p> <p>Welcome to Guan Team!</p>"},{"location":"publications/#_1","title":"Publications","text":""},{"location":"book/main/","title":"\u5f00\u59cb\u4e4b\u524d","text":""},{"location":"book/main/#_2","title":"\u5173\u4e8e\u672c\u6559\u7a0b","text":"<p>\u968f\u7740\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6280\u672f\u5feb\u901f\u53d1\u5c55\uff0c\u5c0f\u578b\u53f0\u5f0f\u6d4b\u5e8f\u4eea\u7684\u51fa\u73b0\u964d\u4f4e\u4e86\u9ad8\u901a\u91cf\u6d4b\u5e8f\u7684\u95e8\u69db\u3002\u5bf9\u4e8e\u5f00\u5c55\u5fae\u751f\u7269\u7279\u522b\u662f\u75c5\u539f\u5fae\u751f\u7269\u7684\u6d4b\u5e8f\u5de5\u4f5c\u7684\u9700\u6c42\uff0c\u5728\u5404\u79cd\u4e34\u5e8a\uff0c\u79d1\u7814\u4ee5\u53ca\u653f\u5e9c\u7684\u5c0f\u578b\u5b9e\u9a8c\u5ba4\u4e2d\u8fc5\u901f\u6269\u5c55\u3002\u76ee\u524d\u5df2\u7ecf\u4e0a\u5e02\u7684\u6bd4\u8f83\u9002\u5408\u5c0f\u578b\u5b9e\u9a8c\u5ba4\u7684\u6d4b\u5e8f\u4eea\u5982 <code>Illumina Miseq</code>\uff0c<code>Illumina NextSeq500</code>\uff0c<code>Ion S5</code>\uff0c<code>Ion PGM</code> \u7b49\uff0c\u5373\u5c06\u4e0a\u5e02\u7684\u6d4b\u5e8f\u4eea\u5982 <code>Illumina MiniSeq</code>\uff0c<code>Qiagen GeneReader</code> \u3002\u9664\u4e86\u4f20\u7edf\u7684\u4e8c\u4ee3\u6d4b\u5e8f\u4eea\uff0c\u4e0d\u9700\u8981\u6269\u589e\u7684\u57fa\u4e8e\u5355\u5206\u5b50\u6d4b\u5e8f\u6280\u672f\u7684\u4e09\u4ee3\u6d4b\u5e8f\u6280\u672f\u7684 <code>PacBio Sequel</code> \u548c\u6700\u8fd1\u5f00\u5c55\u57c3\u535a\u62c9\u5b9e\u65f6\u6d4b\u5e8f\u9879\u76ee\u7684\u57fa\u4e8e\u7eb3\u7c73\u5b54\u6280\u672f\u7684 <code>Oxford MinION</code> \u4ea7\u54c1\u90fd\u662f\u975e\u5e38\u9002\u5408\u5f00\u5c55\u75c5\u539f\u5fae\u751f\u7269\u6d4b\u5e8f\u7684\u5e73\u53f0\u3002</p> <p>\u6d4b\u5e8f\u6570\u636e\u7684\u4e0d\u65ad\u4ea7\u51fa\uff0c\u9700\u8981\u751f\u7269\u4fe1\u606f\u5b66\u4eba\u624d\u6765\u53c2\u4e0e\u5230\u6d4b\u5e8f\u6570\u636e\u7684\u5206\u6790\u4ee5\u4fbf\u83b7\u5f97\u6709\u4ef7\u503c\u7684\u751f\u7269\u5b66\u4fe1\u606f\u5bf9\u4e8e\u8bb8\u591a\u5c0f\u578b\u5b9e\u9a8c\u5ba4\u6765\u8bf4\uff0c\u5f88\u96be\u62db\u52df\u5230\u4f18\u79c0\u7684\u751f\u7269\u4fe1\u606f\u5b66\u4eba\u624d\u3002\u5bf9\u4e8e\u975e\u4e13\u4e1a\u80cc\u666f\u7684\u4eba\u6765\u8bf4\uff0c\u547d\u4ee4\u884c\u4ee5\u53ca\u8f6f\u4ef6\u7684\u5b89\u88c5\u53ef\u80fd\u662f\u5b66\u4e60\u4e2d\u9047\u5230\u7684\u9996\u8981\u96be\u9898\u3002\u672c\u7b14\u8bb0\u4e3b\u8981\u662f\u901a\u8fc7\u4ecb\u7ecd\u5fae\u751f\u7269\uff0c\u7279\u522b\u662f\u75c5\u539f\u7ec6\u83cc\u7684\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u5206\u6790\uff0c\u5e2e\u52a9\u539f\u6765\u4ece\u4e8b\u6e7f\u5b9e\u9a8c\u9886\u57df\u7684\u540c\u4e8b\u80fd\u8f83\u597d\u7684\u4e86\u89e3\u548c\u638c\u63e1\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u5206\u6790\uff0c\u5c06\u5b66\u4e60\u66f2\u7ebf\u53d8\u5f97\u5e73\u7f13\u3002\u540c\u65f6\u4e5f\u5e0c\u671b\u80fd\u5bf9\u4ece\u4e8b\u8be5\u9886\u57df\u7684\u5176\u4ed6\u5de5\u4f5c\u8005\u63d0\u4f9b\u4fbf\u5229\uff0c\u8ba9\u5927\u5bb6\u5728\u9700\u8981\u5206\u6790\u5fae\u751f\u7269\u57fa\u56e0\u7ec4\u6570\u636e\u65f6\uff0c\u80fd\u6709\u4e00\u4e2a\u8d44\u6599\u4e0e\u5b9e\u4f8b\u6c47\u96c6\u7684\u624b\u518c\u53ef\u4ee5\u5feb\u901f\u53c2\u8003\u548c\u5b66\u4e60\u3002</p>"},{"location":"book/main/#linux","title":"Linux \u4e0e\u751f\u7269\u4fe1\u606f","text":"<p>Linux \u4e0e\u751f\u7269\u4fe1\u606f\u5b66\u7d27\u5bc6\u76f8\u5173\uff0c\u8bb8\u591a\u8f6f\u4ef6\u8fd0\u884c\u548c\u6570\u636e\u5206\u6790\u90fd\u9002\u5408\u6216\u5fc5\u987b\u8fd0\u884c\u5728 Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u3002\u5173\u4e8e Linux \u7684\u6559\u5b66\u7f51\u7edc\u4e0a\u4e0d\u8ba1\u5176\u6570\uff0c\u8fd9\u91cc\u53ea\u5bf9\u5728\u6d4b\u5e8f\u6570\u636e\u5206\u6790\u4e2d\u53ef\u80fd\u6d89\u53ca\u5230\u7684\u4e00\u4e9b\u57fa\u672c Linux \u64cd\u4f5c\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"book/main/#_3","title":"\u751f\u4fe1\u8fd0\u884c\u73af\u5883","text":"<p>\u751f\u4fe1\u8f6f\u4ef6\u7684\u8fd0\u884c\u5e73\u53f0\u73af\u5883\u4e00\u822c\u5206\u4e3a\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ol> <li>\u57fa\u4e8eweb\uff1a\u53ef\u4ee5\u5728win/mac/linux/bsd\u7b49\u5e73\u53f0\u8fd0\u884c\uff0c\u53ea\u9700\u7cfb\u7edf\u6709\u56fe\u5f62\u754c\u9762\uff0c\u5e76\u5b89\u88c5\u4e86\u73b0\u4ee3\u5316\u7684\u4e3b\u6d41\u6d4f\u89c8\u5668\u5982chrome/firefox\u7b49\u3002</li> <li>\u7eafwindows\u73af\u5883\uff1a\u5e38\u89c1\u7684\u5546\u4e1a\u8f6f\u4ef6\u5f80\u5f80\u53ea\u80fd\u5728win\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u5982bionumerics\u7b49\u3002</li> <li>\u591a\u5e73\u53f0\u73af\u5883\uff1a\u8bb8\u591a\u751f\u4fe1\u8f6f\u4ef6\u662f\u91c7\u7528java\u5f00\u53d1\uff0c\u53ef\u4ee5\u5728\u591a\u4e2a\u5e73\u53f0\u4e0b\u8fd0\u884c\u3002\u4e00\u4e9bC\u5f00\u53d1\u7684\u7a0b\u5e8f\u4e5f\u6709win/mac/linux\u7248\u672c\u3002</li> <li>\u7eaflinux\u73af\u5883\uff1a\u8bb8\u591a\u751f\u4fe1\u8f6f\u4ef6\u53ea\u80fd\u5728linux/mac\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u5176\u4e2d\u5927\u90e8\u5206\u53c8\u662f\u57fa\u4e8e\u547d\u4ee4\u884c\u800c\u4e0d\u9700\u8981\u56fe\u5f62\u754c\u9762\u3002</li> </ol>"},{"location":"book/1.Raw_Data/01_database/","title":"\u57fa\u56e0\u7ec4\u516c\u5171\u6570\u636e\u5e93","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>\u5185\u5bb9\u7b80\u4ecb</p> <p>\u6d4b\u5e8f\u7684\u6570\u636e\u5982\u539f\u59cb reads \u6570\u636e\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20\u5230 NCBI \u6216 EBI \u7684\u516c\u5171\u6570\u636e\u5e93\uff0c\u53d1\u8868\u7684\u6587\u7ae0\u4e2d\u53ef\u4ee5\u4f7f\u7528\u3002\u6b64\u5916\u516c\u5171\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u4e5f\u53ef\u4ee5\u4e3a\u6211\u4eec\u7684\u7814\u7a76\u63d0\u4f9b\u5e2e\u52a9\u3002\u672c\u8282\u6211\u4eec\u5c31\u6765\u4e86\u89e3\u4e00\u4e0b\u5982\u4f55\u4e0a\u4f20\u548c\u4e0b\u8f7d\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u3002\u9996\u5148\u8ba9\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u7f51\u7edc\u4e0a\u7684\u6d4b\u5e8f\u516c\u5171\u6570\u636e\u5e93\uff1a</p> <p>\u5e38\u89c1\u7684\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u7684\u516c\u5171\u6570\u636e\u5e93\uff1a</p> <ul> <li>SRA \u77ed\u5e8f\u5217\u6570\u636e\u5e93\uff1a\u7531 NCBI \u8d1f\u8d23\u7ef4\u62a4</li> <li>ENA \u6b27\u6d32\u6838\u9178\u6570\u636e\u5e93\uff1a\u7531 EBI \u8d1f\u8d23\u7ef4\u62a4</li> <li>GSA \u4e2d\u56fd\u7ec4\u5b66\u6570\u636e\u5e93\uff1a\u7531\u4e2d\u79d1\u9662\u5317\u4eac\u57fa\u56e0\u7814\u7a76\u6240\u8d1f\u8d23\u7ef4\u62a4</li> </ul> <p>SRA \u662f NCBI \u4e3a\u4e86\u5e94\u5bf9\u8d8a\u6765\u8d8a\u591a\u7684\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u800c\u5728 2007 \u5e74\u5e95\u63a8\u51fa\u7684\u6d4b\u5e8f\u6570\u636e\u5e93\uff0c\u7528\u4e8e\u5b58\u50a8\u3001\u663e\u793a\u3001\u63d0\u53d6\u548c\u5206\u6790\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u3002\u800c ENA \u5219\u662f\u7531 EBI \u8d1f\u8d23\u7ef4\u62a4\u7684\u529f\u80fd\u7c7b\u4f3c\u7684\u6570\u636e\u5e93\uff0c\u540c\u65f6\u4f5c\u4e3a Ensembl\u3001UniProt \u548c ArrayExpress \u7b49\u670d\u52a1\u7684\u5e95\u5c42\u57fa\u7840\u30022\u8005\u5728\u4e3b\u8981\u529f\u80fd\u65b9\u9762\u975e\u5e38\u7c7b\u4f3c\uff0c\u540c\u65f6\u6570\u636e\u4e92\u901a\u3002</p>"},{"location":"book/1.Raw_Data/01_database/#1sra","title":"1.SRA \u6570\u636e\u5e93","text":""},{"location":"book/1.Raw_Data/01_database/#11","title":"1.1 \u7b80\u4ecb","text":"<p>SRA \u662f Sequence Read Archive \u7684\u9996\u5b57\u6bcd\u7f29\u5199\u3002SRA \u4e0e Trace \u6700\u5927\u7684\u533a\u522b\u662f\u5c06\u5b9e\u9a8c\u6570\u636e\u4e0e metadata\uff08\u5143\u6570\u636e\uff09\u5206\u79bb\u3002metadata \u662f\u6307\u4e0e\u6d4b\u5e8f\u5b9e\u9a8c\u53ca\u5176\u5b9e\u9a8c\u6837\u54c1\u76f8\u5173\u7684\u6570\u636e\uff0c\u5982\u5b9e\u9a8c\u76ee\u7684\u3001\u5b9e\u9a8c\u8bbe\u8ba1\u3001\u6d4b\u5e8f\u5e73\u53f0\u3001\u6837\u672c\u6570\u636e(\u7269\u79cd\uff0c\u83cc\u682a\uff0c\u4e2a\u4f53\u8868\u578b\u7b49)\u3002metadata\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b\uff1a</p> <ul> <li>Study\uff1aaccession number \u4ee5 DRP\uff0cSRP\uff0cERP \u5f00\u5934\uff0c\u8868\u793a\u7684\u662f\u4e00\u4e2a\u7279\u5b9a\u76ee\u7684\u7684\u7814\u7a76\u8bfe\u9898\uff0c\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u7814\u7a76\u673a\u6784\u548c\u7814\u7a76\u7c7b\u578b\u7b49\u3002study \u5305\u542b\u4e86\u9879\u76ee\u7684\u6240\u6709 metadata\uff0c\u5e76\u6709\u4e00\u4e2a NCBI \u548c EBI \u5171\u540c\u627f\u8ba4\u7684\u9879\u76ee\u7f16\u53f7\uff08universal project id\uff09\uff0c\u4e00\u4e2a study \u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5b9e\u9a8c\uff08experiment\uff09\u3002</li> <li>Sample\uff1aaccession number\u4ee5 DRS\uff0cSRS\uff0cERS \u5f00\u5934\uff0c\u8868\u793a\u7684\u662f\u6837\u54c1\u4fe1\u606f\u3002\u6837\u672c\u4fe1\u606f\u53ef\u4ee5\u5305\u62ec\u7269\u79cd\u4fe1\u606f\u3001\u83cc\u682a(\u54c1\u7cfb) \u4fe1\u606f\u3001\u5bb6\u7cfb\u4fe1\u606f\u3001\u8868\u578b\u6570\u636e\u3001\u4e34\u5e8a\u6570\u636e,\u7ec4\u7ec7\u7c7b\u578b\u7b49\u3002\u53ef\u4ee5\u901a\u8fc7Trace \u6765\u67e5\u8be2\u3002</li> <li>Experiment\uff1aaccession number \u4ee5 DRX\uff0cSRX\uff0cERX \u5f00\u5934\u3002\u8868\u793a\u4e00\u4e2a\u5b9e\u9a8c\u8bb0\u8f7d\u7684\u5b9e\u9a8c\u8bbe\u8ba1\uff08Design\uff09\uff0c\u5b9e\u9a8c\u5e73\u53f0\uff08Platform\uff09\u548c\u7ed3\u679c\u5904\u7406\uff08processing\uff09\u4e09\u90e8\u5206\u4fe1\u606f\u3002\u5b9e\u9a8c\u662f SRA \u6570\u636e\u5e93\u7684\u6700\u57fa\u672c\u5355\u5143\uff0c\u4e00\u4e2a\u5b9e\u9a8c\u4fe1\u606f\u53ef\u4ee5\u540c\u65f6\u5305\u542b\u591a\u4e2a\u7ed3\u679c\u96c6\uff08run\uff09\u3002</li> <li>Run\uff1aaccession number \u4ee5DRR\uff0cSRR\uff0cERR \u5f00\u5934\u3002\u4e00\u4e2a Run \u5305\u62ec\u6d4b\u5e8f\u5e8f\u5217\u53ca\u8d28\u91cf\u6570\u636e\u3002</li> <li>Submission\uff1a\u4e00\u4e2a study \u7684\u6570\u636e\uff0c\u53ef\u4ee5\u5206\u591a\u6b21\u9012\u4ea4\u81f3 SRA \u6570\u636e\u5e93\u3002\u6bd4\u5982\u5728\u4e00\u4e2a\u9879\u76ee\u542f\u52a8\u524d\u671f\uff0c\u5c31\u53ef\u4ee5\u628a study\uff0cexperiment \u7684\u6570\u636e\u9012\u4ea4\u4e0a\u53bb\uff0c\u968f\u7740\u9879\u76ee\u7684\u8fdb\u5c55\uff0c\u9010\u6279\u9012\u4ea4 run \u6570\u636e\u3002study \u7b49\u540c\u4e8e\u9879\u76ee\uff0csubmission \u7b49\u540c\u4e8e\u6279\u6b21\u7684\u6982\u5ff5\u3002</li> </ul>"},{"location":"book/1.Raw_Data/01_database/#12","title":"1.2 \u6570\u636e\u4e0b\u8f7d","text":"<p>\u8fd9\u4e9b\u516c\u5171\u6570\u636e\u5e93\u7684\u6570\u636e\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u65b9\u5f0f\u4e0b\u8f7d\uff0c\u5982https\u3001ftp\uff0c\u6216\u8005\u4f7f\u7528aspera\u8fd9\u4e2a\u5de5\u5177\u8fdb\u884c\u9ad8\u901f\u4e0b\u8f7d\u3002</p>"},{"location":"book/1.Raw_Data/01_database/#121-aspera-sra","title":"1.2.1 \u7528 Aspera \u5de5\u5177\u4e0b\u8f7d SRA","text":"<p>Aspera \u4ecb\u7ecd</p> <p>Aspera \u662f IBM \u5f00\u53d1\u7684\u52a0\u901f\u5728\u7ebf\u6570\u636e\u4f20\u8f93\u7684\u4e00\u7ec4\u670d\u52a1\u5668\u7aef\u4e0e\u5ba2\u6237\u7aef\u7684\u5e94\u7528\u7a0b\u5e8f\u3002Aspera \u7684\u5404\u4e2a\u5de5\u5177\u53ef\u4ee5\u5728 \u5b98\u65b9\u7f51\u7ad9 \u4e0b\u8f7d\u83b7\u5f97\u3002</p> <p>\u5728\u670d\u52a1\u5668\u4e0a\u6211\u4eec\u53ea\u9700\u8981\u547d\u4ee4\u884c\u5de5\u5177 <code>ascp</code> \u5373\u53ef\u3002\u800c\u5bf9\u4e8e\u684c\u9762\u7528\u6237\u6765\u8bf4\uff0c\u53ef\u4ee5\u9009\u62e9\u5b89\u88c5 Aspera Connent \u7b49\u5de5\u5177\u3002\u7531\u4e8e Ascp Client \u5de5\u5177\u9700\u8981\u767b\u5f55\u540e\u624d\u80fd\u4e0b\u8f7d\uff0c\u56e0\u6b64\u9009\u62e9\u4e86 Aspera Connect \u6765\u5b89\u88c5\u3002\u5b83\u662f Aspera \u7528\u4e8e\u6d4f\u89c8\u5668\u4e0b\u8f7d\u7684\u9ad8\u6548\u63d2\u4ef6\uff0c\u5176\u5185\u5d4c\u4e86 <code>ascp</code> \u547d\u4ee4\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u3002\u5b89\u88c5\u4e86 Aspera Connect \u7684\u5e26\u56fe\u5f62\u754c\u9762\u7684\u5ba2\u6237\u7aef\uff0c\u6d4f\u89c8\u5668\u4f1a\u5728\u6709 Connect, Faspex \u6216\u8005 Shares \u9875\u9762\u7684\u94fe\u63a5\u5904\u6dfb\u52a0 ascp \u4e0b\u8f7d\u5feb\u6377\u6309\u94ae\u3002</p> <p>\u5b89\u88c5 aspera connect</p> <p>Aspera Connect \u4e0b\u8f7d\u89e3\u538b\u7f29\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a .sh \u6587\u4ef6\uff0c\u6267\u884c\u540e\u8fd0\u884c\u540e\u4f1a\u5b89\u88c5\u5230\u5f53\u524d\u7528\u6237 $HOME.aspera/connect \u76ee\u5f55\u4e0b\u3002</p> <pre><code># \u4e0b\u8f7d\u5e76\u89e3\u538b\u7f29\u7a0b\u5e8f\n$ wget http://download.asperasoft.com/download/sw/connect/3.6.1/aspera-connect-3.6.1.110647-linux-64.tar.gz\n$ tar zxf asper-connect-3.6.1.110647-linux.tar.gz\n\n# \u5b89\u88c5\u5230\u672c\u5730\u7528\u6237\n$ ./aspera-connect-3.6.1.110647-linux-64.sh\n\n# \u6dfb\u52a0\u7528\u6237\u6267\u884c\u8def\u5f84\n$ echo 'PATH=\"$PATH:$HOME/.aspera/connect/bin/\"' &gt;&gt; ~/.bashrc\n</code></pre> <p>\u5bf9\u4e8e\u559c\u6b22\u4f7f\u7528\u5ba2\u6237\u7aef\u7684\u684c\u9762\u7528\u6237\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 Aspera Desktop Client \u5ba2\u6237\u7aef\u7a0b\u5e8f\u6765\u4e0b\u8f7d\u6570\u636e\u3002</p> <pre><code>$ sed 's/^INSTALL_DIR/INSTALL_DIR=~/envs/srst2/src/ascp/connect/' aspera-connect-3.6.1.110647-linux-64.sh &gt; install.sh\n$ ./install.sh\n</code></pre> <p>\u4e0b\u8f7d SRA \u6570\u636e</p> <p>\u6ce8\u610f</p> <p>\u6ce8\u610f\u65b0\u7248\u7684<code>ascp</code>\u7528<code>.openssh</code>\u4f5c\u4e3a\u5bc6\u94a5\u6587\u4ef6\u800c\u4e0d\u662f\u539f\u6765\u7684<code>.putty</code></p> <pre><code># ascp \u4e0b\u8f7d SRA \u6570\u636e\n$ ascp -i ~/.aspera/connect/etc/asperaweb_id_dsa.openssh \\\n&gt; --user=anonftp --host=ftp.ncbi.nlm.nih.gov --mode=recv -l 100m -pQTk1 \\\n&gt; /sra/sra-instant/reads/ByRun/sra/SRR/SRR955/SRR955386/SRR955386.sra .\n\n# \u6dfb\u52a0 alias \u7b80\u5316\u64cd\u4f5c\n$ echo \"alias ascp='ascp -i ~/.ascpera/connect/etc/asperaweb_id_dsa.openssh --user=dbtest --host=sra-download.ncbi.nlm.nih.gov --mode=recv -l 100m -pQTk1'\" &gt;&gt; ~/.bashrc\n$ source ~/.bashrc\n\n# \u6d4b\u8bd5\u4e0b\u8f7d\n$ ascp /data/sracloud/srapub/ERR579922 ./ERR578822.sra\n</code></pre>"},{"location":"book/1.Raw_Data/01_database/#122-ftp","title":"1.2.2 ftp \u4e0b\u8f7d","text":"<p>\u4ece\u56fd\u5185\u516c\u7f51\u8bbf\u95ee NCBI FTP \u670d\u52a1\u5668\u5f80\u5f80\u662f\u975e\u5e38\u7f13\u6162\u7684\uff0c\u800c EBI \u5c31\u4e0d\u540c\u4e86\uff0c\u6709\u4e9b\u5730\u65b9\u7684\u901f\u5ea6\u5f88\u5feb\uff0c\u4e0b\u8f7d\u751a\u81f3\u53ef\u4ee5\u8d85\u8fc7 Aspera\u3002\u7531\u4e8e NCBI \u548c EBI \u5171\u4eab\u6570\u636e\u5e93\uff0c\u56e0\u6b64\u5bf9\u4e8e\u56fd\u5185 NCBI \u4e0b\u8f7d\u7f13\u6162\u6216\u8005\u65e0\u6cd5\u7528 ascp \u7684\u7528\u6237\uff0c\u53ef\u4ee5\u8003\u8651\u5728 EBI \u4e0b\u8f7d\u6570\u636e\u3002</p>"},{"location":"book/1.Raw_Data/01_database/#22-sratoolkit","title":"2.2 sratoolkit","text":"<p>NCBI \u5f00\u53d1\u4e86 sratoolkit \u5de5\u5177\u6765\u5e2e\u52a9\u5904\u7406 SRA \u6570\u636e\uff0c\u6b63\u786e\u914d\u7f6e\u540e\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4e0b\u8f7d SRA \u6570\u636e\u3002</p>"},{"location":"book/1.Raw_Data/01_database/#221-sratoolkit","title":"2.2.1 \u5b89\u88c5sratoolkit","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u4ece NCBI \u4e0a\u4e0b\u8f7d\u3002\u6700\u65b0\u7684\u6e90\u7801\u53ef\u4ee5\u5728 Github \u83b7\u5f97\u3002</p> <pre><code># download from NCBI\n$ cd /tmp\n$ wget http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.5.6/sratoolkit.2.5.6-ubuntu64.tar.gz\n$ tar zxf sratoolkit.2.5.6-ubuntu64.tar.gz -C ~/app\n</code></pre>"},{"location":"book/1.Raw_Data/01_database/#222-sra","title":"2.2.2 \u4e0b\u8f7d SRA \u683c\u5f0f\u6587\u4ef6","text":"<p>\u5982\u679c\u4f60\u5b89\u88c5\u5e76\u8bbe\u7f6e\u4e86 Aspera Connect\uff0c\u90a3\u4e48<code>prefetch</code>\u4f1a\u4f18\u5148\u4f7f\u7528<code>ascp</code>\u65b9\u5f0f\u6765\u4e0b\u8f7d\uff0c\u5982\u679c\u6ca1\u6709\u5b89\u88c5\u6216\u5219<code>ascp</code>\u4e0b\u8f7d\u5931\u8d25\uff0c\u5219\u5207\u6362\u6210 HTTP \u65b9\u5f0f\u4e0b\u8f7d sra \u6570\u636e\u3002\u53e6\u5916<code>fastq-dump</code>\u547d\u4ee4\u4e5f\u80fd\u4ece\u8fdc\u7aef\u76f4\u63a5\u4e0b\u8f7d\u6570\u636e\uff0c\u52a0\u4e0a<code>-X 1</code>\u53c2\u6570\uff0c\u4f1a\u9884\u5148\u4e0b\u8f7d\u6700\u524d\u76845\u4e2a reads\uff0c\u52a0\u4e0a<code>-Z</code>\u53c2\u6570\uff0c\u5219\u4f1a\u5c06\u8fd9\u4e9b reads \u6253\u5370\u5230\u7ec8\u7aef\u8f93\u51fa\u3002</p> <pre><code># \u4e0b\u8f7d SRR955386.sra \u5230 \u4f60\u5b89\u88c5 sratoolkit \u65f6\u914d\u7f6e\u7684 public \u76ee\u5f55\u4e2d\uff0c\u9ed8\u8ba4\u662f ~/ncbi/public/sra\n$ prefetch -v SRR955386\n# \u4e0b\u8f7d SRR955386.sra \u5230 \u4f60\u5b89\u88c5 sratoolkit \u65f6\u914d\u7f6e\u7684 public \u76ee\u5f55\u4e2d\uff0c\u9ed8\u8ba4\u662f ~/ncbi/public/sra\uff0c\u5e76\u4e14\u5728\u7ec8\u7aef\u8f93\u51fa5\u884c reads \u6570\u636e\u3002\n$ fastq-dump -X 5 -Z SRR955386\n</code></pre>"},{"location":"book/1.Raw_Data/01_database/#223-fastq","title":"2.2.3 \u5e76\u8f6c\u6362\u6210 .fastq \u683c\u5f0f","text":"<p>\u83b7\u5f97\u4e86 .sra \u6587\u4ef6\u540e\uff0c\u9700\u8981\u5c06\u5176\u8f6c\u6362\u6210 .fastq \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u7528<code>fastq-dump</code>\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9e\u73b0\u3002\u8f6c\u6362\u4e4b\u524d\u8981\u6ce8\u610f\u7684\u662f\u8be5 run \u7684 metadata \u91cc\uff0c\u6d4b\u5e8f\u7c7b\u578b\u662f SE \u8fd8\u662f PE \u7684\u3002</p> <pre><code># \u5c06 sra \u6587\u4ef6\u79fb\u52a8\u5230 ~/data \u76ee\u5f55\u4e2d\n$ mv ~/.ncbi/public/sra/SRR955386.sra ~/data\n# \u5982\u679c\u662f SE \u6d4b\u5e8f\u6570\u636e\uff0c\u76f4\u63a5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\n$ fastq-dump SRR955386.sra\n# \u5982\u679c\u662f PE \u6d4b\u5e8f\u6570\u636e\uff0c\u5219\u8981\u6dfb\u52a0\u53c2\u6570\uff1a--split-files\n$ fastq-dump --split-files SRR955386.sra\n</code></pre>"},{"location":"book/1.Raw_Data/01_database/#224-sepe","title":"2.2.4 SE/PE \u6587\u4ef6\u5224\u65ad","text":"<p>\u6b63\u5e38\u7684 sra \u6587\u4ef6\u7684 metadata \u5e94\u8be5\u5305\u542b\u6d4b\u5e8f\u91c7\u7528\u7684\u662f SE \u8fd8\u662f PE \u7684\u65b9\u5f0f\u3002\u4f46\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u6240\u4e0b\u8f7d\u7684\u5230\u5e95\u662f SE \u8fd8\u662f PE \u683c\u5f0f\u7684\u6587\u4ef6\u53ef\u4ee5\u7528<code>fastq-dump -X 1 --split-spot</code>\u7684\u65b9\u6cd5\u6765\u5224\u65ad\u3002</p> <pre><code># it's SE if nreads=1, and PE when nreads=2\uff0c\u7edf\u8ba1\u6574\u4e2a\u6587\u4ef6\uff0c\u56e0\u6b64\u901f\u5ea6\u6bd4\u8f83\u6162\n$ sra-stat -xs SRR955386.sra | grep \"nreads\"\n\n# \u5982\u679c\u8f93\u51fa\u662f4\uff0c\u90a3\u4e48\u5c31\u662fSE\uff0c\u5982\u679c\u662f8,\u5219\u662fPE\n$ fastq-dump -X 1 --split-spot -Z SRR955386.sra | wc -l\n\n# \u6216\u8005\u52a0\u4e0a\u53c2\u6570\u8ba9 fastq-dump \u81ea\u5df1\u5224\u65ad\n# \u5f53 sra \u6587\u4ef6\u662f SE \u6d4b\u5e8f\u65f6\uff0cfastq-dump\u53ea\u80fddump\u51fa1\u4e2a *_1.fastq \u6587\u4ef6\n$ fastq-dump --split-files ERR493452.sra\n$ mv ERR493452_1.fastq ERR493452.fastq\n</code></pre> <p>\u5f53\u9700\u8981\u5224\u65ad\u6279\u91cf\u4e0b\u8f7d\u7684 sra \u6587\u4ef6\u65f6\uff0c\u533a\u5206\u90a3\u4e9b\u662f PE \u7684\u90a3\u4e9b\u662f SE \u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u811a\u672c\uff1a</p> <pre><code>import os\nimport subprocess\n\n\ndef check_SRA_type(fn):\n    fn = os.path.abspath(fn);\n    try:\n        contents = subprocess.check_output([\"fastq-dump\", \"-X\", \"1\", \"-Z\", \"--split-spot\", fn]);\n    except subprocess.CalledProcessError, e:\n        raise Exception(\"Error running fastq-dump on\", fn);\n    # -X 1 will output 4 lines if SE, and 8 lines if PE\n    if(contents.count(\"\\n\") == 4):\n        return False;\n    elif(contents.count(\"\\n\") == 8):\n        return True:\n    else:\n        raise Exception(\"Unexpected output from fastq-dump on \", filename);\n</code></pre>"},{"location":"book/1.Raw_Data/01_database/#225-entrez","title":"2.2.5 \u5229\u7528entrez\u6279\u91cf\u4e0b\u8f7d","text":"<p>\u5982\u679c\u60f3\u4e0b\u8f7d\u4e00\u4e2a\u5b8c\u6574\u7684 project \u6570\u636e\uff0c\u53ef\u4ee5\u5229\u7528 entrezdirect \u5de5\u5177\u3002</p> <pre><code>~/tmp$ wget ftp://ftp.ncbi.nlm.nih.gov/entrez/entrezdirect/edirect.tar.gz\n~/tmp$ tar zxvf edirect.tar.gz -C ~/app\n~/tmp$ sudo ln -s ~/app/edirect/* /usr/local/sbin/\n~/data$ esearch -db sra -query PRJNA40075  | efetch --format runinfo | cut -d ',' -f 1 | grep SRR | xargs fastq-dump --split-files\n</code></pre> <p>\u5982\u679c\u60f3\u4e0b\u8f7d\u4e0d\u540c research \u7684\u6570\u636e\uff0c\u53ef\u4ee5\u81ea\u5df1\u5efa\u7acb\u4e00\u4e2a accession number list \u7684\u6587\u4ef6\uff0c\u6bd4\u5982\u5229\u7528 NCBI \u7684 entrez \u7f51\u9875\u754c\u9762\uff0c\u5bfc\u51fa\u6240\u9700\u8981\u7684\u6570\u636e accession number\uff0c\u7136\u540e\u5229\u7528 <code>ascp</code> \u4e0b\u8f7d\u3002\u4e0d\u8fc7\u5efa\u8bae<code>ascp</code>\u4e0b\u8f7d\u4e0d\u8981\u592a\u72e0\u5fc3\uff0c\u5426\u5219\u5bb9\u6613\u88ab NCBI \u7ed9\u5c01\u6389\u3002</p>"},{"location":"book/1.Raw_Data/01_database/#3-assembly","title":"3. Assembly \u6570\u636e\u5e93","text":"<p>\u5982\u679c\u4e0d\u9700\u8981\u7814\u7a76 reads \u6570\u636e\uff0c\u800c\u662f\u53ea\u60f3\u7814\u7a76\u62fc\u63a5\u7684\u57fa\u56e0\u7ec4\u6570\u636e\uff0c\u53ef\u4ee5\u4ece NCBI assembly \u6570\u636e\u5e93\u53bb\u5bfb\u627e\u6570\u636e\uff0c\u5e76\u901a\u8fc7 ascp/ftp \u7b49\u5de5\u5177\u4e0b\u8f7d\u3002</p>"},{"location":"book/1.Raw_Data/01_database/#4","title":"4. \u4e0a\u4f20\u6570\u636e","text":"<p>SRA \u4e0a\u4f20\u6d4b\u5e8f\u7ed3\u679c\u53ef\u4ee5\u53c2\u7167 NCBI\u6587\u6863 \u6765\u5b9e\u73b0\u3002\u4e00\u822c\u4e0a\u4f20\u6570\u636e\u5230NCBI SRA\u7684\u8fc7\u7a0b\u9700\u89816\u6b65\uff1a</p> <ol> <li>Create a BioProject for this research</li> <li>Create a BioSample submission for your biological sample(s)</li> <li>Gather Sequence Data Files</li> <li>Enter Metadata on SRA website   4.1 Create SRA submission   4.2 Create Experiment(s) and link to BioProject and BioSample   4.3 Create Run(s)</li> <li>Transfer Data files to SRA</li> <li>Update Submission with PubMed links, Release Date, or Metadata Changes</li> </ol> <p>\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4e0a\u4f20\u7684\u8fc7\u7a0b\u4e2d\u5f88\u591a\u5730\u65b9\u4e00\u65e6\u4fdd\u5b58\u6216\u63d0\u4ea4\u5c31\u4e0d\u53ef\u4ee5\u4fee\u6539\uff0c\u5c24\u5176\u662f\u5404\u5904\u7684Alias\u3002\u4f46\u662f\uff0c\u53ef\u4ee5\u8054\u7cfbNCBI\u7684\u5de5\u4f5c\u4eba\u5458\u4fee\u6539\u5185\u5bb9\u3002NCBI\u7684\u5de5\u4f5c\u6548\u7387\u662f\u5f88\u9ad8\u7684\uff0c\u4e00\u822c\u4e0d\u8d85\u8fc748\u5c0f\u65f6\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u786e\u8ba4\uff0c\u5e76\u62ff\u5230\u767b\u5f55\u53f7\u3002</p>"},{"location":"book/1.Raw_Data/01_database/#big","title":"BIG(\u4e2d\u56fd\u79d1\u5b66\u9662\u5317\u4eac\u57fa\u56e0\u7ec4\u6240)","text":"<p>\u51e0\u4e2a\u6570\u636e\u5e93\u5165\u53e3\uff1a</p> <ul> <li>Bioproject</li> <li>Biosample</li> <li>GSA</li> </ul> <p>\u4e00\u822c\u53ef\u4ee5\u901a\u8fc7FTP\u65b9\u5f0f\u4e0b\u8f7d:w</p>"},{"location":"book/1.Raw_Data/01_database/#_2","title":"\u590d\u5236\u8d77\u70b9\u6570\u636e\u5e93","text":"<p>\u7ec6\u83cc\u3001\u771f\u83cc\u548c\u8d28\u7c92\u7684\u590d\u5236\u8d77\u59cb\u4f4d\u70b9\u6570\u636e\u5e93</p>"},{"location":"book/1.Raw_Data/01_database/#_3","title":"\u8d28\u7c92\u6570\u636e\u5e93","text":""},{"location":"book/1.Raw_Data/01_database/#plsdb","title":"plsdb\u8d28\u7c92\u6570\u636e\u5e93","text":""},{"location":"book/1.Raw_Data/01_database/#eggnog","title":"eggNOG","text":""},{"location":"book/1.Raw_Data/01_database/#go","title":"GO","text":""},{"location":"book/1.Raw_Data/01_database/#reference","title":"Reference","text":"<ol> <li>NCBI\u4e0a\u4f20\u6570\u636e\u6587\u6863</li> <li>\u718a\u7b71\u6676, NCBI\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u5e93SRA\u4ecb\u7ecd, \u751f\u547d\u7684\u5316\u5b66[J], 2010:6, 959-963.</li> <li>http://blog.sciencenet.cn/blog-656335-908140.html</li> <li>https://www.biostars.org/p/139422/</li> <li>https://www.youtube.com/watch?v=NSIkUHKRPpo</li> </ol>"},{"location":"book/1.Raw_Data/02_get-data/","title":"\u547d\u4ee4\u884c\u4e0b\u8f7d\u516c\u5171\u6570\u636e\u5e93\u57fa\u56e0\u7ec4\u6570\u636e","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <ul> <li>SRA</li> <li>Assembly</li> </ul>"},{"location":"book/1.Raw_Data/02_get-data/#sra","title":"SRA \u6570\u636e\u4e0b\u8f7d","text":"<p>\u8fd9\u4e9b\u516c\u5171\u6570\u636e\u5e93\u7684\u6570\u636e\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u65b9\u5f0f\u4e0b\u8f7d\uff0c\u5982https\u3001ftp\uff0c\u6216\u8005\u4f7f\u7528aspera\u8fd9\u4e2a\u5de5\u5177\u8fdb\u884c\u9ad8\u901f\u4e0b\u8f7d\u3002</p>"},{"location":"book/1.Raw_Data/02_get-data/#121-aspera-sra","title":"1.2.1 \u7528 Aspera \u5de5\u5177\u4e0b\u8f7d SRA","text":"<p>Aspera \u4ecb\u7ecd</p> <p>Aspera \u662f IBM \u5f00\u53d1\u7684\u52a0\u901f\u5728\u7ebf\u6570\u636e\u4f20\u8f93\u7684\u4e00\u7ec4\u670d\u52a1\u5668\u7aef\u4e0e\u5ba2\u6237\u7aef\u7684\u5e94\u7528\u7a0b\u5e8f\u3002Aspera \u7684\u5404\u4e2a\u5de5\u5177\u53ef\u4ee5\u5728 \u5b98\u65b9\u7f51\u7ad9 \u4e0b\u8f7d\u83b7\u5f97\u3002</p> <p>\u5728\u670d\u52a1\u5668\u4e0a\u6211\u4eec\u53ea\u9700\u8981\u547d\u4ee4\u884c\u5de5\u5177 <code>ascp</code> \u5373\u53ef\u3002\u800c\u5bf9\u4e8e\u684c\u9762\u7528\u6237\u6765\u8bf4\uff0c\u53ef\u4ee5\u9009\u62e9\u5b89\u88c5 Aspera Connent \u7b49\u5de5\u5177\u3002\u7531\u4e8e Ascp Client \u5de5\u5177\u9700\u8981\u767b\u5f55\u540e\u624d\u80fd\u4e0b\u8f7d\uff0c\u56e0\u6b64\u9009\u62e9\u4e86 Aspera Connect \u6765\u5b89\u88c5\u3002\u5b83\u662f Aspera \u7528\u4e8e\u6d4f\u89c8\u5668\u4e0b\u8f7d\u7684\u9ad8\u6548\u63d2\u4ef6\uff0c\u5176\u5185\u5d4c\u4e86 <code>ascp</code> \u547d\u4ee4\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u3002\u5b89\u88c5\u4e86 Aspera Connect \u7684\u5e26\u56fe\u5f62\u754c\u9762\u7684\u5ba2\u6237\u7aef\uff0c\u6d4f\u89c8\u5668\u4f1a\u5728\u6709 Connect, Faspex \u6216\u8005 Shares \u9875\u9762\u7684\u94fe\u63a5\u5904\u6dfb\u52a0 ascp \u4e0b\u8f7d\u5feb\u6377\u6309\u94ae\u3002</p> <p>\u5b89\u88c5 aspera connect</p> <p>Aspera Connect \u4e0b\u8f7d\u89e3\u538b\u7f29\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a .sh \u6587\u4ef6\uff0c\u6267\u884c\u540e\u8fd0\u884c\u540e\u4f1a\u5b89\u88c5\u5230\u5f53\u524d\u7528\u6237 $HOME.aspera/connect \u76ee\u5f55\u4e0b\u3002</p> <pre><code># \u4e0b\u8f7d\u5e76\u89e3\u538b\u7f29\u7a0b\u5e8f\n$ wget http://download.asperasoft.com/download/sw/connect/3.6.1/aspera-connect-3.6.1.110647-linux-64.tar.gz\n$ tar zxf asper-connect-3.6.1.110647-linux.tar.gz\n\n# \u5b89\u88c5\u5230\u672c\u5730\u7528\u6237\n$ ./aspera-connect-3.6.1.110647-linux-64.sh\n\n# \u6dfb\u52a0\u7528\u6237\u6267\u884c\u8def\u5f84\n$ echo 'PATH=\"$PATH:$HOME/.aspera/connect/bin/\"' &gt;&gt; ~/.bashrc\n</code></pre> <p>\u5bf9\u4e8e\u559c\u6b22\u4f7f\u7528\u5ba2\u6237\u7aef\u7684\u684c\u9762\u7528\u6237\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 Aspera Desktop Client \u5ba2\u6237\u7aef\u7a0b\u5e8f\u6765\u4e0b\u8f7d\u6570\u636e\u3002</p> <pre><code>$ sed 's/^INSTALL_DIR/INSTALL_DIR=~/envs/srst2/src/ascp/connect/' aspera-connect-3.6.1.110647-linux-64.sh &gt; install.sh\n$ ./install.sh\n</code></pre> <p>\u4e0b\u8f7d SRA \u6570\u636e</p> <p>\u6ce8\u610f</p> <p>\u6ce8\u610f\u65b0\u7248\u7684<code>ascp</code>\u7528<code>.openssh</code>\u4f5c\u4e3a\u5bc6\u94a5\u6587\u4ef6\u800c\u4e0d\u662f\u539f\u6765\u7684<code>.putty</code></p> <pre><code># ascp \u4e0b\u8f7d SRA \u6570\u636e\n$ ascp -i ~/.aspera/connect/etc/asperaweb_id_dsa.openssh \\\n&gt; --user=anonftp --host=ftp.ncbi.nlm.nih.gov --mode=recv -l 100m -pQTk1 \\\n&gt; /sra/sra-instant/reads/ByRun/sra/SRR/SRR955/SRR955386/SRR955386.sra .\n\n# \u6dfb\u52a0 alias \u7b80\u5316\u64cd\u4f5c\n$ echo \"alias ascp='ascp -i ~/.ascpera/connect/etc/asperaweb_id_dsa.openssh --user=dbtest --host=sra-download.ncbi.nlm.nih.gov --mode=recv -l 100m -pQTk1'\" &gt;&gt; ~/.bashrc\n$ source ~/.bashrc\n\n# \u6d4b\u8bd5\u4e0b\u8f7d\n$ ascp /data/sracloud/srapub/ERR579922 ./ERR578822.sra\n</code></pre>"},{"location":"book/1.Raw_Data/02_get-data/#122-ftp","title":"1.2.2 ftp \u4e0b\u8f7d","text":"<p>\u4ece\u56fd\u5185\u516c\u7f51\u8bbf\u95ee NCBI FTP \u670d\u52a1\u5668\u5f80\u5f80\u662f\u975e\u5e38\u7f13\u6162\u7684\uff0c\u800c EBI \u5c31\u4e0d\u540c\u4e86\uff0c\u6709\u4e9b\u5730\u65b9\u7684\u901f\u5ea6\u5f88\u5feb\uff0c\u4e0b\u8f7d\u751a\u81f3\u53ef\u4ee5\u8d85\u8fc7 Aspera\u3002\u7531\u4e8e NCBI \u548c EBI \u5171\u4eab\u6570\u636e\u5e93\uff0c\u56e0\u6b64\u5bf9\u4e8e\u56fd\u5185 NCBI \u4e0b\u8f7d\u7f13\u6162\u6216\u8005\u65e0\u6cd5\u7528 ascp \u7684\u7528\u6237\uff0c\u53ef\u4ee5\u8003\u8651\u5728 EBI \u4e0b\u8f7d\u6570\u636e\u3002</p>"},{"location":"book/1.Raw_Data/02_get-data/#22-sratoolkit","title":"2.2 sratoolkit","text":"<p>NCBI \u5f00\u53d1\u4e86 sratoolkit \u5de5\u5177\u6765\u5e2e\u52a9\u5904\u7406 SRA \u6570\u636e\uff0c\u6b63\u786e\u914d\u7f6e\u540e\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4e0b\u8f7d SRA \u6570\u636e\u3002</p>"},{"location":"book/1.Raw_Data/02_get-data/#221-sratoolkit","title":"2.2.1 \u5b89\u88c5sratoolkit","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u4ece NCBI \u4e0a\u4e0b\u8f7d\u3002\u6700\u65b0\u7684\u6e90\u7801\u53ef\u4ee5\u5728 Github \u83b7\u5f97\u3002</p> <pre><code># download from NCBI\n$ cd /tmp\n$ wget http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.5.6/sratoolkit.2.5.6-ubuntu64.tar.gz\n$ tar zxf sratoolkit.2.5.6-ubuntu64.tar.gz -C ~/app\n</code></pre>"},{"location":"book/1.Raw_Data/02_get-data/#222-sra","title":"2.2.2 \u4e0b\u8f7d SRA \u683c\u5f0f\u6587\u4ef6","text":"<p>\u5982\u679c\u4f60\u5b89\u88c5\u5e76\u8bbe\u7f6e\u4e86 Aspera Connect\uff0c\u90a3\u4e48<code>prefetch</code>\u4f1a\u4f18\u5148\u4f7f\u7528<code>ascp</code>\u65b9\u5f0f\u6765\u4e0b\u8f7d\uff0c\u5982\u679c\u6ca1\u6709\u5b89\u88c5\u6216\u5219<code>ascp</code>\u4e0b\u8f7d\u5931\u8d25\uff0c\u5219\u5207\u6362\u6210 HTTP \u65b9\u5f0f\u4e0b\u8f7d sra \u6570\u636e\u3002\u53e6\u5916<code>fastq-dump</code>\u547d\u4ee4\u4e5f\u80fd\u4ece\u8fdc\u7aef\u76f4\u63a5\u4e0b\u8f7d\u6570\u636e\uff0c\u52a0\u4e0a<code>-X 1</code>\u53c2\u6570\uff0c\u4f1a\u9884\u5148\u4e0b\u8f7d\u6700\u524d\u76845\u4e2a reads\uff0c\u52a0\u4e0a<code>-Z</code>\u53c2\u6570\uff0c\u5219\u4f1a\u5c06\u8fd9\u4e9b reads \u6253\u5370\u5230\u7ec8\u7aef\u8f93\u51fa\u3002</p> <pre><code># \u4e0b\u8f7d SRR955386.sra \u5230 \u4f60\u5b89\u88c5 sratoolkit \u65f6\u914d\u7f6e\u7684 public \u76ee\u5f55\u4e2d\uff0c\u9ed8\u8ba4\u662f ~/ncbi/public/sra\n$ prefetch -v SRR955386\n# \u4e0b\u8f7d SRR955386.sra \u5230 \u4f60\u5b89\u88c5 sratoolkit \u65f6\u914d\u7f6e\u7684 public \u76ee\u5f55\u4e2d\uff0c\u9ed8\u8ba4\u662f ~/ncbi/public/sra\uff0c\u5e76\u4e14\u5728\u7ec8\u7aef\u8f93\u51fa5\u884c reads \u6570\u636e\u3002\n$ fastq-dump -X 5 -Z SRR955386\n</code></pre>"},{"location":"book/1.Raw_Data/02_get-data/#223-fastq","title":"2.2.3 \u5e76\u8f6c\u6362\u6210 .fastq \u683c\u5f0f","text":"<p>\u83b7\u5f97\u4e86 .sra \u6587\u4ef6\u540e\uff0c\u9700\u8981\u5c06\u5176\u8f6c\u6362\u6210 .fastq \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u7528<code>fastq-dump</code>\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9e\u73b0\u3002\u8f6c\u6362\u4e4b\u524d\u8981\u6ce8\u610f\u7684\u662f\u8be5 run \u7684 metadata \u91cc\uff0c\u6d4b\u5e8f\u7c7b\u578b\u662f SE \u8fd8\u662f PE \u7684\u3002</p> <pre><code># \u5c06 sra \u6587\u4ef6\u79fb\u52a8\u5230 ~/data \u76ee\u5f55\u4e2d\n$ mv ~/.ncbi/public/sra/SRR955386.sra ~/data\n# \u5982\u679c\u662f SE \u6d4b\u5e8f\u6570\u636e\uff0c\u76f4\u63a5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\n$ fastq-dump SRR955386.sra\n# \u5982\u679c\u662f PE \u6d4b\u5e8f\u6570\u636e\uff0c\u5219\u8981\u6dfb\u52a0\u53c2\u6570\uff1a--split-files\n$ fastq-dump --split-files SRR955386.sra\n</code></pre>"},{"location":"book/1.Raw_Data/02_get-data/#224-sepe","title":"2.2.4 SE/PE \u6587\u4ef6\u5224\u65ad","text":"<p>\u6b63\u5e38\u7684 sra \u6587\u4ef6\u7684 metadata \u5e94\u8be5\u5305\u542b\u6d4b\u5e8f\u91c7\u7528\u7684\u662f SE \u8fd8\u662f PE \u7684\u65b9\u5f0f\u3002\u4f46\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u6240\u4e0b\u8f7d\u7684\u5230\u5e95\u662f SE \u8fd8\u662f PE \u683c\u5f0f\u7684\u6587\u4ef6\u53ef\u4ee5\u7528<code>fastq-dump -X 1 --split-spot</code>\u7684\u65b9\u6cd5\u6765\u5224\u65ad\u3002</p> <pre><code># it's SE if nreads=1, and PE when nreads=2\uff0c\u7edf\u8ba1\u6574\u4e2a\u6587\u4ef6\uff0c\u56e0\u6b64\u901f\u5ea6\u6bd4\u8f83\u6162\n$ sra-stat -xs SRR955386.sra | grep \"nreads\"\n\n# \u5982\u679c\u8f93\u51fa\u662f4\uff0c\u90a3\u4e48\u5c31\u662fSE\uff0c\u5982\u679c\u662f8,\u5219\u662fPE\n$ fastq-dump -X 1 --split-spot -Z SRR955386.sra | wc -l\n\n# \u6216\u8005\u52a0\u4e0a\u53c2\u6570\u8ba9 fastq-dump \u81ea\u5df1\u5224\u65ad\n# \u5f53 sra \u6587\u4ef6\u662f SE \u6d4b\u5e8f\u65f6\uff0cfastq-dump\u53ea\u80fddump\u51fa1\u4e2a *_1.fastq \u6587\u4ef6\n$ fastq-dump --split-files ERR493452.sra\n$ mv ERR493452_1.fastq ERR493452.fastq\n</code></pre> <p>\u5f53\u9700\u8981\u5224\u65ad\u6279\u91cf\u4e0b\u8f7d\u7684 sra \u6587\u4ef6\u65f6\uff0c\u533a\u5206\u90a3\u4e9b\u662f PE \u7684\u90a3\u4e9b\u662f SE \u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u811a\u672c\uff1a</p> <pre><code>import os\nimport subprocess\n\n\ndef check_SRA_type(fn):\n    fn = os.path.abspath(fn);\n    try:\n        contents = subprocess.check_output([\"fastq-dump\", \"-X\", \"1\", \"-Z\", \"--split-spot\", fn]);\n    except subprocess.CalledProcessError, e:\n        raise Exception(\"Error running fastq-dump on\", fn);\n    # -X 1 will output 4 lines if SE, and 8 lines if PE\n    if(contents.count(\"\\n\") == 4):\n        return False;\n    elif(contents.count(\"\\n\") == 8):\n        return True:\n    else:\n        raise Exception(\"Unexpected output from fastq-dump on \", filename);\n</code></pre>"},{"location":"book/1.Raw_Data/02_get-data/#225-entrez","title":"2.2.5 \u5229\u7528entrez\u6279\u91cf\u4e0b\u8f7d","text":"<p>\u5982\u679c\u60f3\u4e0b\u8f7d\u4e00\u4e2a\u5b8c\u6574\u7684 project \u6570\u636e\uff0c\u53ef\u4ee5\u5229\u7528 entrez-direct \u5de5\u5177\u3002</p> <pre><code># \u5e0c\u671b\u4e0b\u8f7d\u7814\u7a76PRJNA40075\u9879\u76ee\u7684\u6570\u636e\n$ esearch -db sra -query PRJNA40075  | efetch --format runinfo | cut -d ',' -f 1 | grep SRR | xargs fastq-dump --split-files\n</code></pre> <p>\u5982\u679c\u60f3\u4e0b\u8f7d\u4e0d\u540c research \u7684\u6570\u636e\uff0c\u53ef\u4ee5\u81ea\u5df1\u5efa\u7acb\u4e00\u4e2a accession number list \u7684\u6587\u4ef6\uff0c\u6bd4\u5982\u5229\u7528 NCBI \u7684 entrez \u7f51\u9875\u754c\u9762\uff0c\u5bfc\u51fa\u6240\u9700\u8981\u7684\u6570\u636e accession number\uff0c\u7136\u540e\u5229\u7528 <code>ascp</code> \u4e0b\u8f7d\u3002\u4e0d\u8fc7\u5efa\u8bae<code>ascp</code>\u4e0b\u8f7d\u4e0d\u8981\u592a\u72e0\u5fc3\uff0c\u5426\u5219\u5bb9\u6613\u88ab NCBI \u7ed9\u5c01\u6389\u3002</p>"},{"location":"book/1.Raw_Data/02_get-data/#3-assembly","title":"3. Assembly \u6570\u636e\u5e93","text":"<p>\u5982\u679c\u4e0d\u9700\u8981\u7814\u7a76 reads \u6570\u636e\uff0c\u800c\u662f\u53ea\u60f3\u7814\u7a76\u62fc\u63a5\u7684\u57fa\u56e0\u7ec4\u6570\u636e\uff0c\u53ef\u4ee5\u4ece NCBI assembly \u6570\u636e\u5e93\u53bb\u5bfb\u627e\u6570\u636e\uff0c\u5e76\u901a\u8fc7 ascp/ftp \u7b49\u5de5\u5177\u4e0b\u8f7d\u3002</p>"},{"location":"book/1.Raw_Data/02_get-data/#4","title":"4. \u4e0a\u4f20\u6570\u636e","text":"<p>SRA \u4e0a\u4f20\u6d4b\u5e8f\u7ed3\u679c\u53ef\u4ee5\u53c2\u7167 NCBI\u6587\u6863 \u6765\u5b9e\u73b0\u3002\u4e00\u822c\u4e0a\u4f20\u6570\u636e\u5230NCBI SRA\u7684\u8fc7\u7a0b\u9700\u89816\u6b65\uff1a</p> <ol> <li>Create a BioProject for this research</li> <li>Create a BioSample submission for your biological sample(s)</li> <li>Gather Sequence Data Files</li> <li>Enter Metadata on SRA website   4.1 Create SRA submission   4.2 Create Experiment(s) and link to BioProject and BioSample   4.3 Create Run(s)</li> <li>Transfer Data files to SRA</li> <li>Update Submission with PubMed links, Release Date, or Metadata Changes</li> </ol> <p>\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4e0a\u4f20\u7684\u8fc7\u7a0b\u4e2d\u5f88\u591a\u5730\u65b9\u4e00\u65e6\u4fdd\u5b58\u6216\u63d0\u4ea4\u5c31\u4e0d\u53ef\u4ee5\u4fee\u6539\uff0c\u5c24\u5176\u662f\u5404\u5904\u7684Alias\u3002\u4f46\u662f\uff0c\u53ef\u4ee5\u8054\u7cfbNCBI\u7684\u5de5\u4f5c\u4eba\u5458\u4fee\u6539\u5185\u5bb9\u3002NCBI\u7684\u5de5\u4f5c\u6548\u7387\u662f\u5f88\u9ad8\u7684\uff0c\u4e00\u822c\u4e0d\u8d85\u8fc748\u5c0f\u65f6\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u786e\u8ba4\uff0c\u5e76\u62ff\u5230\u767b\u5f55\u53f7\u3002</p>"},{"location":"book/1.Raw_Data/02_get-data/#reference","title":"Reference","text":"<ol> <li>NCBI\u4e0a\u4f20\u6570\u636e\u6587\u6863</li> <li>\u718a\u7b71\u6676, NCBI\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u5e93SRA\u4ecb\u7ecd, \u751f\u547d\u7684\u5316\u5b66[J], 2010:6, 959-963.</li> <li>http://blog.sciencenet.cn/blog-656335-908140.html</li> <li>https://www.biostars.org/p/139422/</li> <li>https://www.youtube.com/watch?v=NSIkUHKRPpo</li> </ol>"},{"location":"book/1.Raw_Data/03_entrez/","title":"Entrez","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p></p>"},{"location":"book/1.Raw_Data/03_entrez/#entrez_1","title":"Entrez \u662f\u4ec0\u4e48","text":""},{"location":"book/1.Raw_Data/03_entrez/#entrez-direct","title":"\u73a9\u8f6c entrez-direct","text":"<p>\u5185\u5bb9\u7b80\u4ecb</p> <p>NCBI \u7684 Entrez \u5de5\u5177\u529f\u80fd\u975e\u5e38\u5f3a\u5927\uff0c\u65e2\u53ef\u4ee5\u4ece web \u9875\u9762\u8bbf\u95ee NCBI \u6765\u67e5\u8be2\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528 Entrez \u63d0\u4f9b\u7684 Web Services \u6765\u5b9e\u73b0\u8bf8\u591a\u529f\u80fd\uff08\u7f16\u5199\u7b2c\u4e09\u65b9\u7a0b\u5e8f\u7b49\uff09\u3002\u6b64\u5916 NCBI \u8fd8\u63d0\u4f9b\u4e86 Entrez \u7684\u547d\u4ee4\u884c\u5de5\u5177 edirect<sup>1</sup>\u3002edirect \u5168\u540d\u4e3a Entrez Direct\uff0c\u91cc\u9762\u5305\u542b\u4e86\u4e00\u7ec4\u5404\u53f8\u5176\u804c\u7684\u5de5\u5177\u548c\u811a\u672c\uff0c\u901a\u8fc7 Linux \u7cfb\u7edf\u4e0b\u7684\u7ba1\u9053pipeline<sup>2</sup>\u529f\u80fd\u8054\u5408\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u5b9e\u73b0\u9ad8\u6548\u7684\u8fdb\u884c Entrez \u7684\u68c0\u7d22\uff0c\u6293\u53d6\uff0c\u8fc7\u6ee4\uff0c\u6392\u5e8f\u7b49\u64cd\u4f5c\u3002</p>"},{"location":"book/1.Raw_Data/03_entrez/#1","title":"1. \u5b89\u88c5","text":""},{"location":"book/1.Raw_Data/03_entrez/#11","title":"1.1 \u4e0b\u8f7d\u5b89\u88c5","text":"<p>edirect \u76f4\u63a5\u4e0b\u8f7d\u9884\u7f16\u8bd1\u5305\uff0c\u6dfb\u52a0\u5230\u7cfb\u7edf\u8def\u5f84\u4e2d\u5373\u53ef\u3002</p> <pre><code># \u4e0b\u8f7d edirect \u5b89\u88c5\u5305\n$ wget ftp://ftp.ncbi.nlm.nih.gov/entrez/entrezdirect/edirect.tar.gz\n\n# \u5c06 edirect \u5b89\u88c5\u5728\u7528\u6237 app \u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u81ea\u884c\u9009\u62e9\u5b89\u88c5\u8def\u5f84\n$ tar zxvf edirect.tar.gz -C ~/apps\n\n# \u8fd0\u884c\u5b89\u88c5\u811a\u672c\n$ cd ~/apps/edirect\n$ bash ./setup.sh\n\n# \u6dfb\u52a0\u8f6f\u4ef6\u5b89\u88c5\u76ee\u5f55\u5230\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u4e2d\n$ echo \"export PATH='\\$PATH:\\$HOME/apps/edirect/'\" &gt;&gt; ~/.bashrc\n$ source ~/.bashrc\n</code></pre> <p>\u5b89\u88c5\u8bf4\u660e</p> <p>\u8010\u5fc3\u7b49\u5f85\u4e00\u4f1a\uff0c\u5f53\u770b\u5230\u4e0b\u9762\u5b57\u7b26\u65f6\uff0c\u8868\u793a\u5b89\u88c5\u6210\u529f\u3002 <pre><code>ENTREZ DIRECT HAS BEEN SUCCESSFULLY INSTALLED AND CONFIGURED\n</code></pre></p> <p>\u4e5f\u53ef\u4ee5\u4e0d\u8fd0\u884c <code>setup.sh</code> \u76f4\u63a5\u4f7f\u7528 edirect \u7684\u4e00\u4e9b\u5de5\u5177\uff0c\u4e0d\u8fc7\u5982\u679c\u8981\u4f7f\u7528\u5168\u90e8\u529f\u80fd\uff0c\u6709\u4e9bperl\u6a21\u5757\u9700\u8981\u5b89\u88c5\uff0c\u8fd0\u884c <code>setup.sh</code> \u6765\u81ea\u52a8\u5b8c\u6210 CPAN \u7684 modual \u5b89\u88c5\u4ee5\u53ca go \u7248\u672c\u7684 xtract \u7684\u7f16\u8bd1\uff08\u4e0d\u8fd0\u884c\u5b89\u88c5\u811a\u672c\u4f1a\u8c03\u7528 perl \u7248\u672c\u7684 xtract\uff0c\u6570\u636e\u91cf\u5927\u65f6\u901f\u5ea6\u7565\u6162\uff09\u3002</p> <p>\u63d0\u793a</p> <p>\u5bf9\u4e8e\u90e8\u5206\u64cd\u4f5c\u7cfb\u7edf\u5982 ubuntu \u7b49\uff0cuname \u4f4d\u4e8e /bin\uff0c\u800c xtract \u63a5\u53e3\u8c03\u7528\u811a\u672c\u4f7f\u7528 /usr/bin/uname \u6765\u5224\u65ad\u4f7f\u7528\u90a3\u4e2a\u7248\u672c\u7684 xtract\uff0c\u5982\u679c\u8981\u5728\u8fd9\u4e9b\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u6b63\u5e38\u4f7f\u7528 xtract\uff0c\u9700\u8981\u8ba9\u7a0b\u5e8f\u5728\u6b63\u786e\u8def\u5f84\u53ef\u8bc6\u522b\uff0c\u8fd9\u91cc\u901a\u8fc7\u6dfb\u52a0\u7cfb\u7edf link \u5230 /usr/bin/unname\u3002</p> <pre><code># \u67e5\u770b uname \u8def\u5f84\u3002\n$ which uname\n\n# \u5982\u679c\u662f\u4f4d\u4e8e /bin/ \u4e0b\uff0c\u5c06\u5176\u94fe\u63a5\u5230 /usr/bin/ \u4e0b\u5373\u53ef\u3002\n$ sudo ln -s /bin/uname /usr/bin/uname\n</code></pre>"},{"location":"book/1.Raw_Data/03_entrez/#12-conda","title":"1.2 conda \u4e2d\u5b89\u88c5","text":"<p>\u5982\u679c\u7cfb\u7edf\u901a\u8fc7 conda \u8fdb\u884c\u8f6f\u4ef6\u7ba1\u7406\uff0c\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u5b89\u88c5\u3002</p> <pre><code>$ conda install entrez-direct\n</code></pre> <p>\u4e0d\u8fc7 conda \u5b89\u88c5\u7684\u8fd8\u662f perl \u7248\u672c\u7684 xtract\uff0c\u800c\u4e0d\u662f go \u7248\u672c\u7684\uff0c\u9700\u8981\u5230 conda/pkgs \u5305\u6839\u76ee\u5f55\u4e2d\u7684 edirect \u76f8\u5e94\u76ee\u5f55\uff0c\u7528 <code>setup.sh</code> \u81ea\u884c\u7f16\u8bd1\u540e\u751f\u6210 xtract.Linux(Linux \u64cd\u4f5c\u7cfb\u7edf)\uff0c\u5c06\u5176\u590d\u5236\u5230 conda \u7684 bin \u8def\u5f84\u5373\u53ef\u3002go \u7248\u672c\u7684 xtract \u53ef\u4ee5\u7528 -help \u53c2\u6570\u67e5\u770b\u5e2e\u52a9\u3002</p>"},{"location":"book/1.Raw_Data/03_entrez/#2","title":"2. \u57fa\u672c\u7528\u6cd5","text":"<p>\u8868. \u6700\u5e38\u7528\u7684\u5de5\u5177\u53c2\u89c1\u4e0b\u8868</p> \u5de5\u5177\u540d\u79f0 \u5de5\u5177\u7528\u9014 \u5e38\u7528\u53c2\u6570 esearch \u641c\u7d22\u547d\u4ee4\uff0c\u5c06\u6240\u8981\u68c0\u7d22\u7684\u5185\u5bb9\u63d0\u4ea4\u5230 Entrez \u4e2d\uff0c\u8fd4\u56de\u76f8\u5e94\u7684\u7ed3\u679c\u8bb0\u5f55 -db\u3001-query efetch \u4e0b\u8f7d NCBI \u6570\u636e\u5e93\u4e2d\u7684\u8bb0\u5f55\u548c\u62a5\u544a\u5e76\u4ee5\u76f8\u5e94\u683c\u5f0f\u6253\u5370\u8f93\u51fa -db\u3001-id\u3001-format\u3001-mode einfo \u83b7\u53d6\u76ee\u6807\u7ed3\u679c\u5728\u6570\u636e\u5e93\u4e2d\u7684\u4fe1\u606f -db\u3001-dbs\u3001-fields\u3001-links elink \u5bf9\u76ee\u6807\u7ed3\u679c\u5728\u5176\u4ed6\u6570\u636e\u5e93\u4e2d\u6bd4\u914d\u7ed3\u679c -db\u3001-id\u3001-related\u3001-target\u3001-name epost \u4e0a\u4f20 UIDs \u6216\u8005 \u5e8f\u5217\u767b\u8bb0\u53f7 -db\u3001-id\u3001-format\u3001-input\u3001-label efilter \u5bf9\u4e4b\u524d\u7684\u68c0\u7d22\u7ed3\u679c\u8fdb\u884c\u8fc7\u6ee4\u6216\u9650\u5236 -query\u3001-sort\u3001-field xtract \u5c06esearch\u83b7\u5f97\u7684 XML \u683c\u5f0f\u7ed3\u679c\u8f6c\u6362\u6210\u8868\u683c\u683c\u5f0f -pattern\u3001-if\u3001-block\u3001-element\u3001-sep\u3001-filter esummary \u83b7\u5f97 XML \u683c\u5f0f\u7684\u5efa\u7acb -db\u3001-id\u3001-format\u3001-mode ecitmatch \u7edf\u8ba1\u5f15\u7528\u6570\u636e -journal\u3001-year\u3001-volume\u3001-page\u3001-author"},{"location":"book/1.Raw_Data/03_entrez/#21-esearch","title":"2.1 esearch","text":"<p>esearch \u8d1f\u8d23\u68c0\u7d22\u5e76\u8fd4\u56de xml \u683c\u5f0f\u7684\u547d\u4e2d\u60c5\u51b5\u3002\u4f7f\u7528 esearch \u547d\u4ee4\uff0c\u76f8\u5f53\u4e8e\u5e73\u65f6\u4f60\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee NCBI\uff0c\u5728 GQuery \u7684 nucletide \u6570\u636e\u5e93\u641c\u7d22\u89c1\u9762\u641c\u7d20\u5173\u952e\u5b57 <code>salmonella</code>\uff0c\u8fd4\u56de\u547d\u4e2d\u7ed3\u679c\u3002</p> <pre><code>$ esearch -db nuccore -query \"salmonella\"\n</code></pre> <p>\u7ec8\u7aef\u91cc\u4f1a\u8fd4\u56de\u547d\u4e2d\u7ed3\u679c\uff1a</p> <pre><code>&lt;ENTREZ_DIRECT&gt;\n  &lt;Db&gt;nuccore&lt;/Db&gt;\n  &lt;WebEnv&gt;NCID_1_153624467_130.14.18.34_9001_1490828308_1411373464_0MetA0_S_MegaStore_F_1&lt;/WebEnv&gt;\n  &lt;QueryKey&gt;1&lt;/QueryKey&gt;\n  &lt;Count&gt;2093561&lt;/Count&gt;\n  &lt;Step&gt;1&lt;/Step&gt;\n&lt;/ENTREZ_DIRECT&gt;\n</code></pre> <p>esearch \u9700\u8981\u8bbe\u7f6e\u7684\u53c2\u6570\u6709 -db\uff08\u6240\u8981\u641c\u7d22\u7684\u76ee\u6807\u6570\u636e\u5e93\uff09\u548c -query\uff08\u6240\u8981\u641c\u7d22\u7684\u5173\u952e\u8bcd\uff09\u3002</p> <p>\u7ed3\u679c\u9ed8\u8ba4\u8fd4\u56de xml \u683c\u5f0f\u7684\u6570\u636e\uff08\u53c2\u89c1 <code>&lt;ENTREZ_DIRECT&gt;...&lt;/ENTREZ_DIRECT&gt;</code>\uff09\uff0c\u5176\u4e2d  \u4e2d\u7684\u6570\u503c\u8868\u793a\u68c0\u7d22\u547d\u4e2d\u7684\u8bb0\u5f55\u6570\uff0c\u8fd9\u4e0e NCBI \u7684 Entrez \u7f51\u9875\u754c\u9762\u91cc\u8fdb\u884c\u68c0\u7d22\u64cd\u4f5c\u7684\u7ed3\u679c\u662f\u4e00\u81f4\u7684\u3002 <p>esearch \u8fd8\u6709\u4e00\u4e2a\u53c2\u6570 -sort \u53ef\u4ee5\u6839\u636e\u6570\u636e\u5e93\u7c7b\u578b\u8fd4\u56de\u4e0d\u540c\u7684\u6392\u5e8f\u65b9\u5f0f\u3002\u9ed8\u8ba4\u7684\u6392\u5e8f\u65b9\u5f0f\u662f\u6309\u7167\u65f6\u95f4\u9006\u5e8f\u6392\u5217\u7684\u3002\u60f3\u8981\u5f97\u5230\u51c6\u786e\u7684\u67e5\u8be2\u7ed3\u679c\uff0c\u4f18\u5316 query \u5f88\u91cd\uff0c\u53ef\u4ee5\u53c2\u89c1 Filter \u76f8\u5173\u5185\u5bb9\u3002</p>"},{"location":"book/1.Raw_Data/03_entrez/#22-efetch","title":"2.2 efetch","text":"<p>efetch \u53ef\u4ee5\u7528\u6765\u4e0b\u8f7d\u5404\u4e2a\u6570\u636e\u5e93\u7684\u5404\u79cd\u683c\u5f0f\u6570\u636e\u3002\u4f60\u53ef\u4ee5\u901a\u8fc72\u79cd\u65b9\u5f0f\u4e0b\u8f7d\uff1a</p> <ol> <li>\u7528 esearch \u83b7\u5f97\u547d\u4e2d\u8bb0\u5f55\u540e\u518d\u4e0b\u8f7d\u3002\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\uff0c\u5c31\u4f1a\u4e0b\u8f7d\u6240\u6709\u7ed3\u679c\u5e76\u4fdd\u5b58\u5230 result.fasta \u6587\u4ef6\u4e2d\u3002</li> </ol> <pre><code>$ esearch -db nuccore -query \"salmonella\" -days 10 | \\\n&gt; efetch -format fasta -db nuccore &gt; result.fasta\n</code></pre> <p>Warning</p> <p>\u4e00\u5b9a\u8981\u6ce8\u610f\u641c\u7d22\u547d\u4e2d\u503c\u7684\u6570\u91cf\uff0c\u5173\u952e\u8bcd\u547d\u4e2d\u592a\u591a\uff0c\u6570\u636e\u91cf\u4f1a\u592a\u5927\uff0c\u5168\u90e8\u4e0b\u8f7d\u53ef\u80fd\u76f4\u63a5\u8fdb\u5165\u5047\u6b7b\u72b6\u6001\u3002\u5e94\u8be5\u901a\u8fc7\u8bbe\u7f6e\u53c2\u6570\u6765\u9650\u5b9a\u641c\u7d22\u7ed3\u679c\u3002\u5f53\u4e0d\u786e\u5b9a\u65f6\uff0c\u5148\u7528esearch\u5de5\u5177\u770b\u8fd4\u56de\u7684\u547d\u4e2d\u503c\u6709\u591a\u5c11\u518d\u51b3\u5b9a\u662f\u5426\u8fdb\u4e00\u6b65\u9650\u5b9a\u3002</p> <ol> <li>\u76f4\u63a5\u6307\u5b9a id \u4e0b\u8f7d</li> </ol> <pre><code>$ efetch -db pubmed -id 2142131 -format txt\n</code></pre> <p>efetch \u8bbe\u7f6e\u7684\u53c2\u6570\u662f -db\uff0c\u5c06\u641c\u7d22\u547d\u4e2d\u7684\u8bb0\u5f55\u4ece\u8be5\u6570\u636e\u5e93\u8fdb\u884c\u3002\u5982\u679c esearch \u68c0\u7d22\u7684\u7ed3\u679c\u548c\u9700\u8981\u4e0b\u8f7d\u7684\u7ed3\u679c\u6765\u81ea\u540c\u4e00\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4e0d\u6dfb\u52a0 -db \u53c2\u6570\uff0c\u7cfb\u7edf\u4f1a\u9ed8\u8ba4\u4f7f\u7528esearch\u7684\u6570\u636e\u5e93\u3002</p> <p>efetch \u8fd8\u8981\u8bbe\u7f6e\u7684\u53c2\u6570\u662f -format\uff0c\u5373\u4e0b\u8f7d\u6570\u636e\u7684\u683c\u5f0f\u3002\u5e38\u7528\u7684\u6709 xml \u683c\u5f0f\uff0c\u540e\u7eed\u53ef\u4ee5\u901a\u8fc7 xtract \u548c linux \u4e00\u4e9b\u547d\u4ee4\u884c\u5de5\u5177\u6765\u505a\u5904\u7406\u3002\u4f60\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0 -id \u53c2\u6570\u76f4\u63a5\u8fdb\u884c\u4e0b\u8f7d\u800c\u4e0d\u901a\u8fc7 esearch \u68c0\u7d22\u540e\u4e0b\u8f7d\u3002\u5982\u4e0b\u9762\u4f8b\u5b50\u4e2d\u5c06 pubmed id 2137412 \u7684\u6587\u732e\u8f93\u51fa\uff0c\u683c\u5f0f\u4e3a Medline<sup>3</sup></p> <pre><code># \u641c\u7d22 pubmed \u6570\u636e\u5e93\u7f16\u53f7 2137412 \u7684\u6587\u732e\uff0c\u4ee5 medline \u683c\u5f0f\u8f93\u51fa\n$ efetch -db pubmed -id 2137412 -format medline\n</code></pre> <p>\u5bf9\u4e8e efetch \u53ef\u4ee5\u4e0b\u8f7d\u90a3\u4e9b\u6570\u636e\u5e93\uff0c\u5bf9\u4e8e\u5404\u4e2a\u6570\u636e\u5e93\u540d\u79f0\u548c\u6570\u636e\u683c\u5f0f\uff0c\u53ef\u4ee5\u7528<code>-h</code>\u6765\u67e5\u770b</p> <pre><code>$ efetch -h\n</code></pre>"},{"location":"book/1.Raw_Data/03_entrez/#23-xtract","title":"2.3 xtract","text":"<p>edirect \u7684\u6838\u5fc3\u547d\u4ee4\uff0c\u7531\u4e8e esearch \u67e5\u8be2\u548c\u4e0b\u8f7d\u7684\u6570\u636e\u5e38\u5e38\u662f xml \u683c\u5f0f\u7684\uff0c\u5bf9\u4e8e XML<sup>4</sup> \u683c\u5f0f\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u7528 xtract \u5de5\u5177\u5c06\u5176\u8f6c\u6362\u6210\u7eaf\u6587\u672c\u683c\u5f0f\u7684\u5185\u5bb9\u3002xtract \u4e0d\u4ec5\u53ef\u4ee5\u8f6c\u6362 NCBI \u7684 XML \u683c\u5f0f\u6587\u4ef6\uff0c\u5bf9\u4e8e\u4efb\u4f55\u901a\u7528\u7684 XML \u683c\u5f0f\u6587\u4ef6\u90fd\u53ef\u4ee5\u8fdb\u884c\u8f6c\u6362\u3002</p> <p>xtract \u57fa\u672c\u7528\u6cd5\uff1a</p> <pre><code># \u8bfb\u53d6 XML \u6587\u4ef6\u65b9\u5f0f\n$ xtract -input XML-file.xml\n</code></pre> <p>\u4e00\u822c\u6211\u4eec\u90fd\u662f\u901a\u8fc7\u7ba1\u9053\u5de5\u5177 Pipeline \u7ec4\u5408 esearch \u548c efetch \u7b49\u5de5\u5177\u83b7\u5f97 XML \u683c\u5f0f\u7684 NCBI \u6570\u636e\u5e93\u547d\u4e2d\u8bb0\u5f55\u540e\uff0c\u518d\u7528 xtract \u8fdb\u884c\u5904\u7406\u3002</p> <pre><code>$ esearch -db pubmed -query 'E. coli AND (2016/12/30[pdat]:2016/12/31[pdat])' | \\\n&gt; efetch -format xml | xtract -pattern PubmedArticle -element \\\n&gt; MedlineCitation/PMID Journal/ISOAbbreviation ArticleTitle\n</code></pre> <p>\u8fd9\u6761\u547d\u4ee4\u5c06\u68c0\u7d22\u5230\u7684\u6587\u732e\u8bb0\u5f55\u8f6c\u6362\u6210\u884c\uff0c\u518d\u4ee5 PMID\uff0c\u6742\u5fd7\u540d\u7f29\u5199\u548c\u6587\u7ae0\u9898\u76ee\u4e3a\u5217\u5c55\u5f00\u3002\u547d\u4ee4\u6253\u5370\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>28239441J Public Health AfrQuality and labeling information of Mo       ringa oleifera products marketed for HIV-infected people in Zimbabwe.\n28115890Korean J Food Sci Anim ResourAntimicrobial Activity of Kefir against Variou     s Food Pathogens and Spoilage Bacteria.\n28110668Enzyme Microb. Technol  .A novel thermophilic and halophilic esterase from Janibacter sp. R02,   the first member of a new lipase family (Family XVII).\n...\n27030192J.   Vet. Sci.Development and evaluation of an immunochromatographic assay   using a gp51 monoclonal antibody for the detection of antibodies against the bovine leukemia virus.\n</code></pre> <p>\u5f53\u6211\u4eec\u4e0d\u6e05\u695aXML\u5143\u7d20\u7ed3\u6784\u65f6\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u547d\u4ee4\u6253\u5370\u51fa\u6811\u5f62\u7ed3\u6784\u3002</p> <pre><code>$ xtract -input my.xml -outline\n</code></pre> <p>xtract \u53ef\u4ee5\u7075\u6d3b\u7684\u6539\u53d8\u6570\u636e\u7684\u683c\u5f0f\uff0c\u6240\u4ee5\u6d89\u53ca\u7684\u53c2\u6570\u4e5f\u6bd4\u8f83\u591a\u3002\u8981\u60f3\u83b7\u5f97\u81ea\u5df1\u9700\u8981\u7684\u6570\u636e\u683c\u5f0f\uff0c\u8981\u60f3\u7528\u597d edirect\uff0c\u638c\u63e1\u597d xtract \u7684\u7528\u6cd5\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002</p> <p>-pattern \u53c2\u6570: \u5c06 xml \u683c\u5f0f\u6570\u636e\uff0c\u5c06\u8f6c\u6362\u6210\u884c\u683c\u5f0f\u6570\u636e\u3002\u6bcf\u4e00\u4e2aelement\u5305\u542b\u7684\u6570\u636e\u505a\u4e3a\u4e00\u884c\u3002 <p>xtract \u547d\u4ee4\u9996\u5148\u8981\u901a\u8fc7 -pattern \u5b9a\u4e49\u6240\u8981\u5206\u6790\u7684\u6570\u636e\u7ea7\u522b\u3002\u6bd4\u5982\u5bf9\u4e8e pubmed \u6570\u636e\u5e93\uff0cefetch \u8f93\u51fa -format \u683c\u5f0f\u4e3a docsum\uff0c\u90a3\u4e48\u6211\u4eec\u4e00\u822c\u8981\u6293\u53d6\u7684\u662f\u6bcf\u4e00\u4e2a\u547d\u4e2d\u7684\u6587\u732e\u8bb0\u5f55\uff0c-pattern \u5c31\u53ef\u4ee5\u7528 DocumentSummary \u5143\u7d20\u3002\u5982\u679c\u4f60\u53ea\u60f3\u77e5\u9053\u6240\u6709\u547d\u4e2d\u6587\u732e\u7684\u4f5c\u8005\uff08\u6bd4\u5982\u6309\u7167\u6b21\u6570\u6392\u5e8f\uff09\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u5c06 -pattern \u5b9a\u4e49\u4e3a Author\u3002</p> <p>-element \u53c2\u6570: \u5c06 -pattern \u5b9a\u4e49\u7684\u884c\u4e2d\u4ee5\u6bcf\u4e2aelement\u5f62\u6210\u4e00\u5217\u3002\u6bcf\u4e2aelement\u4ee5tab\u952e\u5206\u9694\u3002</p> <p>\u6bcf\u4e2a -pattern \u5b9a\u4e49\u540e\uff0c\u8981\u591a -pattern \u5b9a\u4e49\u7684\u5143\u7d20\u7684\u5b50\u5143\u7d20\u8fdb\u884c\u8f93\u51fa\uff0c\u5c31\u8981\u7528\u5230 -element \u53c2\u6570\u4e86\u3002-element \u53ef\u4ee5\u8ddf\u591a\u4e2a\u5b50\u5143\u7d20\uff0c\u9ed8\u8ba4\u4ee5tab\u952e\u5206\u5272\u3002\u4f46\u662f\u8981\u6ce8\u610f\u7684\u662f\u5b50\u5143\u7d20\u5fc5\u987b\u662f\u552f\u4e00\u5b50\u5143\u7d20\uff0c\u6bd4\u5982 -pattern \u5982\u679c\u5b9a\u4e49\u4e3a DocumentSummary\uff0c\u90a3\u4e48\u6bcf\u4e2a DocumentSummary \u5143\u7d20\u6709\u4e00\u4e2a Authors \u5b50\u5143\u7d20\uff0c\u800c\u6bcf\u4e2a Authors \u6709\u591a\u4e2a Author \u5b50\u5143\u7d20\uff08\u56e0\u4e3a\u4e00\u7bc7\u6587\u732e\u6709\u591a\u4e2a\u4f5c\u8005\uff09\uff0c\u5982\u679c\u76f4\u63a5\u5c06 -element Author\uff0c\u662f\u65e0\u6cd5\u8fd4\u56de\u4f5c\u8005\u4fe1\u606f\u7684\u3002\u9700\u8981\u7528 -block \u53c2\u6570\u628a Authors \u5217\u8f6c\u6362\u6210\u884c\u518d\u8fdb\u884c\u5206\u5272\u3002</p> <p>-block \u53c2\u6570: \u53ef\u4ee5\u5c06\u67d0\u4e2aXML\u6807\u7b7e\u4e0b\u7684\u591a\u4e2a\u76f8\u540c\u6807\u7b7e\u8f6c\u6362\u6210\u4e00\u884c\u7684\u591a\u4e2a\u5143\u7d20\uff0c\u6700\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u5728 <code>pubmed</code> \u6570\u636e\u5e93\u68c0\u7d22\u6587\u732e\u65f6\u4e0b\u591a\u4e2a\u6807\u7b7e\u6253\u5370\u51fa\u6765\u3002 <pre><code>$ esearch -db pubmed -query \"Salmonella[ORGN]\" -days 5 | efetch -format xml | \\\n&gt; xtract -pattern PubmedArticle -block Author -sep \" \" -element LastName,Initials\n</code></pre> <p>-tab\u3001-sep \u53c2\u6570: \u5c06\u591a\u6761 element \u8bb0\u5f55\u5206\u5272\u3002</p> <p>/: \u4e3b\u8981\u7528\u5728\u5b9a\u4e49\u8fde\u7eed\u591a\u5c42\u6807\u7b7e\u7684\u5b9a\u4e49\u4e0a\u3002\u6bd4\u5982PMID\u6807\u7b7e\u5373\u53ef\u4ee5\u5728 MedlineCitation \u6807\u7b7e\u4e0b\uff0c\u6709\u65f6\u4e5f\u4f1a\u5728 RefSource \u6807\u7b7e\u4e0b\u3002\u6240\u4ee5\u8981\u660e\u786e\u68c0\u7d22\u6587\u732e\u7684 PMID\uff0c\u5c31\u5e94\u8be5\u7528 MedlineCitation/PMID</p> <p>@: \u6307\u5b9a XML \u5143\u7d20 element \u7684 attribute \u503c</p> <p>-if\u3001-if/-equals\u3001-if/-contains \u53c2\u6570: \u6761\u4ef6\u8fd0\u7b97\u7b26</p> <p>-and\u3001-or\u3001-position\u3001-def \u53c2\u6570: \u5173\u7cfb\u8fd0\u7b97\u7b26</p>"},{"location":"book/1.Raw_Data/03_entrez/#24-elink","title":"2.4 elink","text":"<p>\u5f53\u6211\u4eec\u8981\u68c0\u7d22\u4e00\u4e2a\u6570\u636e\u5e93\u6570\u636e\u6240\u5173\u8054\u5230\u5176\u4ed6\u6570\u636e\u5e93\u65f6\uff0c\u5c31\u8981\u7528\u5230elink\u5de5\u5177\u4e86\u3002\u6bd4\u5982\u6211\u4eec\u5148\u5728SRA\u6570\u636e\u5e93\u4e2d\u641c\u7d22\u5230\u6240\u6709\u9f20\u4f24\u5bd2\u6c99\u95e8\u83cc\u7684SRA\u5b9e\u9a8c\u6570\u636e\uff0c\u7136\u540e\u94fe\u63a5\u5230biosample\u6570\u636e\u5e93\uff0c\u83b7\u5f97\u8fd9\u4e9b\u83cc\u682a\u7684\u751f\u7269\u6837\u672c\u4fe1\u606f\u3002</p> <pre><code>$ esearch -db sra -query \"salmonella typhimurium\" | elink -target biosample | efetch -format docsum &gt; result.xml\n</code></pre>"},{"location":"book/1.Raw_Data/03_entrez/#24-einfo","title":"2.4 einfo","text":"<p>\u5bf9\u4e8e NCBI \u6570\u636e\u5e93\u7684\u5404\u9879\u590d\u6742\u53c2\u6570\uff0c\u5b57\u6bb5\u7b49\u8981\u5b8c\u5168\u4e86\u89e3\u548c\u638c\u63e1\u6bd4\u8f83\u56f0\u96be\u3002edirect \u91cc\u63d0\u4f9b\u4e86 einfo \u5de5\u5177\uff0c\u8fd9\u6837\u5176\u4ed6\u5de5\u5177\u6240\u80fd\u8bbf\u95ee\u7684\u5177\u4f53\u6570\u636e\u5e93\u3001\u5b57\u6bb5\u548c\u53ef\u94fe\u63a5\u6570\u636e\u5e93\u7b49\u4fe1\u606f\u90fd\u53ef\u4ee5\u7528 einfo \u4e86\u89e3\u3002</p> <pre><code># \u67e5\u8be2 `esearch -db` \u53c2\u6570\u6240\u80fd\u8bbf\u95ee\u7684\u6240\u6709\u6570\u636e\u5e93\u540d\u79f0\n$ einfo -dbs | sort\n\n# \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u5b57\u6bb5\u60c5\u51b5\uff0c\u5982 sra \u6570\u636e\u5e93\u6240\u6709\u5bf9\u5e94\u7684\u5b57\u6bb5\u540d\u79f0\n$ einfo -db sra -fields\n\n# \u67e5\u8be2\u6570\u636e\u5e93\u6240\u6709\u53ef\u94fe\u63a5\u7684\u5176\u4ed6\u6570\u636e\u5e93\n$ einfo -db sra -links\n</code></pre>"},{"location":"book/1.Raw_Data/03_entrez/#3","title":"3. \u9ad8\u7ea7\u68c0\u7d22","text":"<p>\u5de5\u5177 esearch \u548c efilter \u5728\u505a\u68c0\u7d22\u65f6\u5982\u679c\u505a\u597d\u7b5b\u9009\uff0c\u80fd\u6709\u52a9\u4e8e\u83b7\u5f97\u51c6\u786e\u7684\u7ed3\u679c\u3002\u7b5b\u9009\u67092\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u901a\u8fc7\u6dfb\u52a0\u53c2\u6570\u6765\u7b5b\u9009\u3002\u53e6\u4e00\u79cd\u662f\u5bf9 query \u53c2\u6570\u6dfb\u52a0\u5b57\u6bb5\u5b9a\u4e49\u6765\u7b5b\u9009\u3002</p> <p>\u53c2\u6570\u8fc7\u6ee4\uff1a</p> <p>\u5e38\u7528\u7684\u53c2\u6570\u4e3a\u65e5\u671f\u53c2\u6570</p> <ul> <li>-days 100\uff1a100\u5929\u5185\u7684\u68c0\u7d22\u6761\u4ef6\u547d\u4e2d</li> <li>-maxdate\uff1a\u65f6\u95f4\u6bb5\u6700\u5927\u65e5\u671f\uff0c\u683c\u5f0f\u53ef\u4ee5\u662f 2001\uff0c2001/01/01</li> <li>-mindate\uff1a\u65f6\u95f4\u6bb5\u6700\u5c0f\u65e5\u671f\uff0c\u683c\u5f0f\u53ef\u4ee5\u662f 2001\uff0c2001/01/01</li> <li>-datetype: PDAT \u53d1\u5e03\u65f6\u95f4\uff1bMDAT \u4fee\u6539\u65f6\u95f4</li> </ul> <p>\u5b57\u6bb5\u5b9a\u4e49\uff1a</p> <p>-query\u53c2\u6570: esearch \u548c efilter \u901a\u8fc7\u6dfb\u52a0\u8be5\u53c2\u6570\u8fdb\u884c\u68c0\u7d22\u6216\u8fc7\u6ee4\u76f8\u5e94\u7684\u5173\u952e\u8bcd\uff0cquery\u53c2\u6570\u53ef\u4ee5\u6dfb\u52a0 filter\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u53ef\u9009\u62e9\u7684filter\u53ef\u4ee5\u7528\u4e0b\u9762\u547d\u4ee4\u6765\u67e5\u770b\u3002</p> <pre><code># \u67e5\u770bsra\u6570\u636e\u5e93\u7684filter\n$ einfo -db sra -fields\n\n# \u67e5\u770bsra\u6570\u636e\u5e93field\uff0c\u7528xtract\u683c\u5f0f\u5316\u8f93\u51fa\n$ einfo -db sra | xtract -pattern Field -element Name Description\n</code></pre> <p>-query \u68c0\u7d22\u8bcd\u53ef\u4ee5\u7528\u903b\u8f91\u5173\u952e\u8bcd\u6784\u5efa\u903b\u8f91\u5173\u7cfb\uff1a</p> <ul> <li>AND\uff1a\u548c</li> <li>OR\uff1a\u6216</li> <li>NOT\uff1a\u975e</li> <li>()\uff1a\u5171\u540c\u5b9a\u4e49</li> </ul> <p>-query \u68c0\u7d22\u8bcd\u8fd8\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\uff1a</p> <ul> <li>\"*\"\u661f\u53f7\u8868\u793a\u4efb\u610f\u4e2a\u5339\u914d\u7684\u5b57\u7b26</li> </ul> <p>-query \u5b57\u7b26\u4e32\u5b9a\u4e49</p> <p>\u5efa\u8bae\u7528 '...' \u5b9a\u4e49 -query \u503c\uff0c\u91cc\u9762\u7684\u5404\u4e2a\u5173\u952e\u8bcd\u7528 AND/OR \u7b49\u5efa\u7acb\u903b\u8f91\u5173\u7cfb\u3002\u5173\u952e\u8bcd\u7ec4\u6dfb\u52a0 filter \u65f6\u7528 \"...\" \u5b9a\u4e49\u3002\u5982\uff1a</p> <p>-query '\"salmonella paratyphi A\"[ORGN] AND latest[filter] AND \"complete genome[filter]\"'</p>"},{"location":"book/1.Raw_Data/03_entrez/#4","title":"4. \u5177\u4f53\u793a\u4f8b","text":"<p>\u4e0b\u9762\u6211\u4eec\u5c31\u7528\u51e0\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u6765\u5c1d\u8bd5 edirect \u7684\u529f\u80fd\u3002\u7ed3\u5408 Linux \u5176\u4ed6\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u4ee5\u6781\u5927\u7684\u63d0\u5347\u6211\u4eec\u5728\u547d\u4ee4\u884c\u754c\u9762\u4e0b\u68c0\u7d22\u548c\u6293\u53d6 NCBI \u6570\u636e\u5e93\u7684\u6548\u7387\u3002</p> <p>\u67e5\u770b2014~2016\u5e74\u53d1\u8868\u7684\u970d\u4e71\u5f27\u83ccCTX\u76f8\u5173\u6587\u732e\u7684\u6458\u8981</p> <p>\u7528\u5173\u952e\u8bcd vibrio cholerae CTX \u68c0\u7d22 pubmed \u6570\u636e\u5e93\uff0c\u5c06\u641c\u7d22\u5230\u7684\u6587\u732e\u7684\u6458\u8981\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\uff0c\u65b9\u4fbf\u67e5\u770b\u3002\u7531\u4e8e\u662f\u6587\u672c\u683c\u5f0f\u7684\u5185\u5bb9\uff0c\u65b9\u4fbf\u540e\u671f\u8fdb\u4e00\u6b65\u5904\u7406\uff0c\u6bd4\u5982\u63d0\u53d6\u5355\u8bcd\u8fdb\u884c\u8bcd\u9891\u8ba1\u7b97\uff0c\u7528\u7ffb\u8bd1API\u5c06\u6458\u8981\u8fdb\u884c\u81ea\u52a8\u7ffb\u8bd1\u7b49\u7b49\u3002</p> <pre><code># \u793a\u4f8b\u4e3a\u4e86\u51cf\u5c11\u547d\u4e2d\u6570\u636e\uff0c\u8bbe\u7f6e\u4e86\u53d1\u5e03\u65e5\u671f\u7684 -mindate \u548c maxdata\n$ esearch -db pubmed -mindate 2014 -maxdate 2016 -datetype PDAT \\\n&gt; -query \"vibrio cholerae CTX\" | efetch -format abstract &gt; abstract.txt\n\n# \u65e5\u671f\u8bbe\u7f6e\u7684\u53e6\u4e00\u79cd\u5199\u6cd5\n$ esearch -db pubmed -query \"vibrio cholerae CTX AND \\\n&gt; (2014[pdat]:2016[pdat])\" | efetch -format abstract &gt; abstract.txt\n</code></pre> <p>\u67e5\u770b\u6587\u7ae0\u4f5c\u8005</p> <p>\u5e38\u5e38\u4f1a\u5bf9\u67d0\u4e00\u7c7b\u6587\u7ae0\uff0c\u6216\u8005\u67d0\u4e00\u4e2a\u671f\u520a\u7684\u6587\u7ae0\u4f5c\u8005\u8fdb\u884c\u5173\u6ce8\uff0c\u8fd9\u91cc\u6839\u636e\u68c0\u7d22\u5173\u952e\u8bcd\uff0c\u683c\u5f0f\u5316\u8f93\u51fa\u6587\u7ae0\u7684ID\u548c\u4f5c\u8005\u5217\u8868\u3002\u8fd9\u4e5f\u662f xtract \u6700\u5e38\u89c1\u7684\u5e94\u7528\u4e4b\u4e00\u3002</p> <pre><code># \u68c0\u7d22\u5173\u952e\u8bcd\uff0c\u4ee5\u6700\u8fd1300\u5929\u4e3a\u8303\u56f4\n$ esearch -db pubmed -query \"listeria monocytogenes AND prfA\" -days 300 | \\\n&gt; efetch -format xml | xtract -pattern PubmedArticle \\\n&gt; -element MedlineCitation/PMID -block Author -sep \" \" \\\n&gt; -element LastName,Initials\n</code></pre> <p>\u67e5\u770b\u8fd1300\u5929\u4ee5\u6765\u53d1\u8868\u7684\u6587\u7ae0\u4e2d\uff0c\u4f5c\u8005\u4e2d\u6709\u53ebJim\u7684\u6240\u6709\u6587\u7ae0\u9898\u76ee</p> <p>\u5229\u7528 pubmed \u6570\u636e\u5e93\u7684 filter [FULL], \u67e5\u8be2\u6240\u6709\u4f5c\u8005\u5217\u8868\u91cc\u6709\u53ebJim\u7684\u6587\u7ae0\u6807\u9898\uff0c\u8fd9\u91cc\u91c7\u7528 medline \u683c\u5f0f\u8f93\u51fa\uff0c\u5982\u679c\u8981\u8fdb\u4e00\u6b65\u505a\u683c\u5f0f\u5316\u53ef\u4ee5\u7528xml\u683c\u5f0f\u518d\u7528xtract\u91cd\u65b0\u6392\u7248\u6253\u5370\u3002</p> <pre><code>$ esearch -db pubmed -days 300 -query \"Jim[FULL]\" | efetch -format medline | \\\n&gt; grep TI | awk -F'- ' '{print $2}'\n</code></pre> <p>\u67e5\u770b2016\u5e74CDC\u53d1\u5e03\u7684\u6240\u6709\u7528miseq\u6d4b\u5e8f\u7684\u6c99\u95e8\u83cc\u6587\u5e93\u5236\u5907\u65b9\u6cd5</p> <p>\u60f3\u8981\u4e86\u89e3 CDC \u5f00\u5c55\u7684 miseq \u6c99\u95e8\u83cc\u6d4b\u5e8f\u65f6\u91c7\u7528\u7684\u6587\u5e93\u6784\u5efa\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5229\u7528 sra \u6570\u636e\u5e93\u7684 runinfo\u4fe1\u606f\u8f93\u51fa\u83b7\u5f97\u3002</p> <pre><code>$ esearch -db sra -query \"salmonella[OGRN] miseq[PLAT] EDBL-CDC\" \\\n&gt; -mindate 2016/01/01 -maxdate 2016/12/31 -datetype PDAT | \\\n&gt; efetch -format runinfo | cut -d ',' -f 12 &gt; library.txt\n</code></pre> <p>\u7ed8\u5236\u5355\u589e\u674e\u65af\u7279\u83cchlyA\u86cb\u767d\u8d28\u8fdb\u5316\u6811\u56fe</p> <pre><code>$ esearch -db protein -query \"listeriolysin hlyA NOT partial\" |\n&gt; efetch -format fasta &gt; hlyA.fasta\n$ mafft hlyA.fasta &gt; hlyA.mafft.fasta\n$ raxml -m GTRGAMMA -p 12345 -s hlyA.mafft.fasta -f a -x 12345 -N 100 -T 40 -n hlyA\n</code></pre> <p>\u5bf910\u5e74\u5185\u53d1\u8868\u7684\u68c0\u7d22\u6587\u732e\u7684\u4f5c\u8005\u6392\u5e8f</p> <pre><code>$ esearch -db pubmed -days 3650 -datetype PDAT -query \"hlyA\" | \\\n&gt; efetch -format xml | \\\n&gt; xtract -pattern Author -element LastName | \\\n&gt; sort-uniq-count-rank\n</code></pre> <p>\u67e5\u770b taxonomy</p> <p>taxonomy \u6570\u636e\u5e93\u7684 filter [NXLV] \u53ef\u4ee5\u76f4\u63a5\u8f93\u51faspecies\u7ea7\u522b</p> <pre><code># \u83b7\u5f97 taxonomy \u6570\u636e\u5e93\u91cc lis \u6216 sal \u5f00\u5934\u7684\u5206\u7c7b\u540d\n$ esearch -db taxonomy -query \"lis* OR sal*\" | efetch -db taxonomy -format txt\n\n# \u83b7\u5f97 species \u7ea7\u7684\u6240\u6709\u6c99\u95e8\u83cc\n$ esearch -db taxonomy -query \"Salmonella[NXLV]\" | efetch -db taxonomy -format txt\n</code></pre> <p>\u4e0b\u8f7d\u6240\u6709\u7532\u578b\u526f\u4f24\u5bd2\u6c99\u95e8\u83cc\u57fa\u56e0\u7ec4\u5e8f\u5217</p> <pre><code>$ esearch -db nuccore -query \"Salmonella[porgn:__txid54388] complete genome\" | \\\n&gt; efetch -db nuccore -format fasta &gt; SPA.fasta\n</code></pre> <p>\u83b7\u53d6SRA\u6570\u636e\u5e93\u4e2d\u76ee\u7684\u6570\u636e\u7684\u6d4b\u5e8f\u6837\u672c\u5730\u7406\u4fe1\u606f</p> <pre><code>$ esearch -db sra -query \"China\" -days 1 | elink -target biosample | \\\n&gt; efetch -format docsum | xtract -pattern DocumentSummary -element Accession \\\n&gt; -block Attribute -if Attribute@attribute_nam \\\n&gt; -equals lat_lon -element Attribute\n</code></pre> <p>\u83b7\u5f97\u67d0\u4e2abioproject\u4e0b\u7684\u6240\u6709sra run\u7684\u4fe1\u606f</p> <pre><code>$ eserach -db bioproject -query \"PRJNA209644\" | elink -target sra | \\\n&gt; efetch -format docsum | xtract -pattern DocumentSummary -ACC @acc \\\n&gt; -block DocumentSummary -element \"&amp;ACC\"\n</code></pre> <p>\u4e0b\u8f7dassembly\u6570\u636e\u5e93\u7684refseq\u5e8f\u5217</p> <pre><code>$ esearch -db assembly -query \"Salmonella enterica[ORGN] AND 2010[GRLS]\" | \\\n&gt; efetch -format docsum | xtract -pattern DocumentSummary \\\n&gt; -element FtpPath_RefSeq | awk -F\"/\" '{print $0\"/\"$NF\"_genomic.fna.gz\"}' | \\\n&gt; xargs wget\n</code></pre> <p>\u67e5\u770bassembly meta\u4fe1\u606f</p> <p>NCBI \u7684 Assembly \u6570\u636e\u5e93\u5305\u542b\u4e86 RefSeq \u6570\u636e\u5e93\u7684\u57fa\u56e0\u7ec4\u6570\u636e\uff0c\u9009\u62e9\u76f8\u5e94\u7684\u7269\u79cd\u53ef\u4ee5\u83b7\u5f97\u8be5\u7269\u79cd\u7684\u57fa\u56e0\u7ec4\u62fc\u63a5\u5e8f\u5217\uff0c\u6709\u5b8c\u6210\u56fe\u4e5f\u6709\u975e\u5b8c\u6210\u56fe\u3002</p> <pre><code>$ esearch -db assembly -query '\"salmonella paratyphi A\"[ORGN] AND latest[FILT]' | \\\n&gt; efetch -format docsum | xtract -pattern Meta -block Stats \\\n&gt; -tab '\\n' -sep '\\t' -element Stat@category Stat | sort -ur &gt; meta.txt\n</code></pre> <pre><code>import pandas as pd\nimport seaborn as sns\n\ndf = pd.read_table(\"meta.txt\")\nsns.jointplot(x=\"contig_count\", y=\"scaffold_n50\", data=df)\n</code></pre> <p></p> <p>\u83b7\u53d6SRA\u83cc\u682a\u4fe1\u606f</p> <p>\u5bf9\u67d0\u4e2a\u7269\u79cd\u5f00\u5c55\u8fdb\u5316\u7814\u7a76\u65f6\uff0c\u6211\u4eec\u5f80\u5f80\u4f1a\u7adf\u53ef\u80fd\u6536\u96c6\u516c\u5171\u6570\u636e\u5e93\u4e2d\u7684\u83cc\u682a\u80cc\u666f\u4fe1\u606f\u3002\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u641c\u7d22\u67d0\u4e2a bioproject\uff0c\u7136\u540e\u83b7\u5f97\u8be5\u7814\u7a76\u7684\u6240\u6709\u6d4b\u5e8f\u6570\u636e\u7684 sra \u80cc\u666f\u4fe1\u606f\u3002\u901a\u8fc7 \\&lt;SAMPLE_ATTRIBUTE&gt; \u5143\u7d20\u4e0b\u7684\u5404\u4e2a TAG \u548c VALUE \u6765\u63d0\u53d6\u6240\u9700\u4fe1\u606f\u3002</p> <pre><code>$ esearch -db bioproject -query 273159 | elink -target sra | \\\n&gt; efetch -format xml | xtract -pattern EXPERIMENT_PACKAGE -tab \",\" \\\n&gt; -element RUN@accession -block SAMPLE_ATTRIBUTE -tab \"\\t\" -sep \":\" \\\n&gt; -element TAG,VALUE &gt; sample.txt\n</code></pre> <pre><code>$ head sample.txt\n</code></pre> <p>\u8fd9\u6837\u8f93\u51fa\u7684\u95ee\u9898\u5728\u4e8e\u5404\u4e2a\u6d4b\u5e8f\u6570\u636e\u7684 SAMPLE_ATTRIBUTE \u7684 TAG \u987a\u5e8f\u662f\u4e71\u5e8f\u7684\uff0c\u6bcf\u4e2a SRR \u8f93\u51fa\u7684\u987a\u5e8f\u4e0d\u540c\u5bfc\u81f4\u5404\u4e2a\u5b57\u6bb5\u8981\u91cd\u65b0\u6392\u5e8f\uff0c\u6bd4\u8f83\u9ebb\u70e6\u3002\u5982\u679c\u6211\u4eec\u53ea\u9700\u8981\u5176\u4e2d\u4e00\u4e2a\u5b57\u6bb5\uff0c\u53ef\u4ee5\u7528 -if *** -eqauls *** \u6765\u8fc7\u6ee4\u3002\u6bd4\u5982\u4e0b\u9762\u4ee3\u7801\u6211\u4eec\u8f93\u51fa\u83cc\u682a\u540d\u79f0\uff1a</p> <pre><code>$ esearch -db bioproject -query 273159 | elink -target sra | \\\n&gt; efetch -format xml | xtract -pattern EXPERIMENT_PACKAGE -tab \",\" \\\n&gt; -element RUN@accession -block SAMPLE_ATTRIBUTE -if TAG -equals \"strain\" \\\n&gt; -element VALUE | sort &gt; strain-name.csv\n</code></pre> <p><code>-if</code>\u5728\u4e00\u884c\u8f93\u51fa\u4e2d\u4e0d\u80fd\u53cd\u590d\u4f7f\u7528\uff0c\u5982\u679c\u8981\u540c\u65f6\u5bf9\u591a\u4e2a\u6837\u54c1\u4fe1\u606f\u5b57\u6bb5\u5206\u522b\u8f93\u51fa\uff0c\u6211\u4eec\u91c7\u7528\u53d8\u901a\u7684\u65b9\u6cd5\uff0c\u5148\u628a xml \u6570\u636e\u4fdd\u5b58\u5230\u672c\u5730\uff0c\u7136\u540e\u5faa\u73af\u5206\u522b\u8f93\u51fa\u5404\u4e2a\u6240\u9700\u5185\u5bb9\uff0c\u7528 sort \u6392\u5e8f\uff0c\u518d\u7528 paste \u5408\u5e76\u3002</p> <pre><code># \u5206\u522b\u8f93\u51fa csv \u683c\u5f0f\u7684\u6570\u636e\n$ for i in serovar strain isolate_name_alias collection_date isolation_source; \\\n&gt; do xtract -input bioproject.xml -pattern EXPERIMENT_PACKAGE -tab \",\" \\\n&gt; -element RUN@accession -block SAMPLE_ATTRIBUTE -if TAG -equals $i -element \\\n&gt; VALUE | sort &gt; $i; done\n# \u5408\u5e76 csv\n$ paste -d , strain serovar isolate_name_alias collection_date &gt; sample.csv\n</code></pre>"},{"location":"book/1.Raw_Data/03_entrez/#reference","title":"Reference","text":"<ol> <li> <p>Entrez Direct: E-utilities on the UNIX Command Line \u21a9</p> </li> <li> <p>Unix Pipeline Wikipedia \u21a9</p> </li> <li> <p>Medline Element Description \u21a9</p> </li> <li> <p>XML \u21a9</p> </li> </ol>"},{"location":"book/1.Raw_Data/04_blast/","title":"Blast \u4f7f\u7528\u8bf4\u660e","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>\u5185\u5bb9\u7b80\u4ecb</p> <p>Blast \u5de5\u5177\u53ef\u4ee5\u8fdb\u884c\u5e8f\u5217\u76f8\u4f3c\u6027\u6bd4\u5bf9\uff0c\u5728 NGS \u6570\u636e\u5206\u6790\u4e2d\u7ecf\u5e38\u4f1a\u88ab\u4f7f\u7528\u5230\uff0c\u7279\u522b\u662f\u4e00\u4e9b\u5de5\u5177\u4e2d\u9700\u8981 Blast \u6216 Blast+ \u7a0b\u5e8f\u6765\u4f5c\u4e3a\u7b2c\u4e09\u65b9\u6bd4\u5bf9\u5de5\u5177\u8c03\u7528\u3002\u62ff\u5230\u6d4b\u5e8f\u5b8c\u6210\u7684\u8349\u56fe\u540e\uff0c\u56e0\u4e3a\u57fa\u56e0\u7ec4\u6570\u636e\u8f83\u5927\uff0c\u8fde\u63a5NCBI\u7f51\u7ad9\u5f80\u5f80\u53c8\u975e\u5e38\u7f13\u6162\uff0c\u6240\u4ee5\u8981\u505a Blast \u6bd4\u5bf9\u7684\u8bdd\u90fd\u9700\u8981\u505a Local Blast\u3002\u8fd9\u91cc\u4ecb\u7ecd2\u4e2a\u65b9\u5f0f\u6765\u5b9e\u73b0\uff1a</p> <ol> <li>\u7528\u547d\u4ee4\u884c\u8fdb\u884c\u672c\u5730 Blast</li> <li>\u5feb\u901f\u6784\u5efa Blast Web \u670d\u52a1</li> </ol>"},{"location":"book/1.Raw_Data/04_blast/#1-blast","title":"1. Blast \u539f\u7406","text":""},{"location":"book/1.Raw_Data/04_blast/#2-blast","title":"2. \u5728\u7ebf blast","text":""},{"location":"book/1.Raw_Data/04_blast/#3-local-blast","title":"3. \u57fa\u4e8e\u547d\u4ee4\u884c\u7684 Local Blast","text":"<p><code>Blast</code> \u548c <code>NCBI Blast</code> \u662f NCBI \u5148\u540e\u53d1\u5e03\u7684\u5e8f\u5217\u6bd4\u5bf9\u5de5\u5177\u3002<code>**B**asic **L**ocal **A**lignment **S**earch **T**ool</code>\u5de5\u5177\u6700\u65e9\u516c\u5e03\u4e0e1989\u5e74\uff0c\u6211\u4eec\u4e00\u822c\u90fd\u79f0\u547c\u5176\u4e3a<code>Blast</code>\u30022009\u5e74 NCBI \u4e3a\u4e86\u514b\u670d<code>Blast</code>\u7684\u4e0d\u8db3\u4e4b\u5904\uff0c\u4e3a\u4ee5\u540e\u5f00\u53d1\u65b9\u4fbf\uff0c\u91cd\u5199\u4ee3\u7801\uff0c\u65b0\u7684<code>NCBI Blast</code>\uff08\u4e5f\u79f0\u5176\u4e3a<code>Blast+</code>\uff09\u5de5\u5177\u5e94\u8fd0\u800c\u751f\u3002\u65b0\u7248<code>Blast</code>\u5de5\u5177\u5728\u901f\u5ea6\u4e0a\u6709\u4e86\u63d0\u5347\uff0c\u5728\u8f93\u5165\u8f93\u51fa\u4e0a\u4e5f\u66f4\u4e3a\u7075\u6d3b\u3002</p> <p><code>[Blast](ftp://ftp.ncbi.nlm.nih.gov/blast/)</code>\u5de5\u5177\u6700\u65b0\u7248\u662f2012\u5e74\u53d1\u5e03\u7684**2.2.26**\uff0c\u76ee\u524d\u5df2\u4e0d\u518d\u63d0\u4f9b\u66f4\u65b0\u3002<code>NCBI Blast</code>\u76ee\u524d\u6700\u65b0\u7248\u4e3a**2.9.0**\u3002\u8981\u533a\u52062\u8005\u4e5f\u5f88\u7b80\u5355\uff0c2\u4e2a\u7248\u672c\u7684\u7a0b\u5e8f\u8fd0\u884c\u65b9\u5f0f\u4e0d\u540c\uff1a<code>Blast</code> \u662f\u901a\u8fc7 blastall -p \u7684\u65b9\u5f0f\u8c03\u7528\u5b50\u7a0b\u5e8f\u6765\u6bd4\u5bf9\u641c\u7d22\u7684\uff0c\u800c<code>Blast+</code>\u5219\u662f\u76f4\u63a5\u4f7f\u7528blastn\u6216blastp\u7b49\u5b50\u7a0b\u5e8f\u6765\u6bd4\u5bf9\u641c\u7d22\u3002\u53e6\u5916\u524d\u8005\u7528formatdb\u7a0b\u5e8f\u6765\u683c\u5f0f\u5316\u6570\u636e\u5e93\uff0c\u540e\u8005\u7528makeblastdb\u7a0b\u5e8f\u6765\u683c\u5f0f\u5316\u6570\u636e\u3002</p>"},{"location":"book/1.Raw_Data/04_blast/#31-blast","title":"3.1 Blast","text":"<p>Blast\u7684\u4e0b\u8f7d\u4e0e\u5b89\u88c5</p> <pre><code># Ubuntu \u4e2d\u5b89\u88c5 blast\n$ sudo apt install blast2\n\n# \u6216\u8005\u76f4\u63a5\u4e0b\u8f7dNCBI Linux\u9884\u7f16\u8bd1\u5305\uff0c\u5e76\u89e3\u538b\u7f29\u5b89\u88c5\n$ wget ftp://ftp.ncbi.nih.gov/blast/executables/release/2.2.26/blast-2.2.26-x64-linux.tar.gz\n$ tar -zxvf blast-2.2.26-x64 -C ~/app\n# \u5728\u7cfb\u7edf\u53ef\u6267\u884c\u8def\u5f84\u4e2d\u6dfb\u52a0 blast \u94fe\u63a5\n$ sudo ln -s ~/app/blast-2.2.26-x64/blastall /usr/local/sbin\n\n# \u901a\u8fc7 conda \u5b89\u88c5 blast\n(blast)$ conda install blast-legacy\n</code></pre> <p>\u8fd0\u884c Blast</p> <p><code>Blast</code>\u901a\u8fc7\u8c03\u7528 blastall \u7a0b\u5e8f\u6765\u8c03\u7528\u4e0d\u540c\u5b50\u7a0b\u5e8f\u5b9e\u73b0\u4e0d\u540c\u7c7b\u578b\u5e8f\u5217\u6bd4\u5bf9\u3002\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165<code>blastall</code>\uff0c\u4f1a\u6253\u5370\u51fa\u4e00\u4efd\u53c2\u6570\u5217\u8868\u3002\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>man blast</code>\u6765\u67e5\u770b<code>Blast</code>\u5de5\u5177\u7684\u7528\u6237\u624b\u518c\u3002</p> <pre><code># \u8fd0\u884c\u4e3b\u547d\u4ee4\n$ blastall\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <pre><code>-p: \u6307\u5b9a\u8981\u8fd0\u884c\u7684 blast \u7a0b\u5e8f\u3002\u53ef\u4ee5\u8c03\u7528\u7684\u6709:\n    `blastp`             \u5c06\u6c28\u57fa\u9178\u5e8f\u5217\u4e0e\u86cb\u767d\u8d28\u6570\u636e\u5e93\u6bd4\u5bf9\n    `blastn`             \u5c06\u6838\u9178\u5e8f\u5217\u4e0e\u6838\u9178\u6570\u636e\u5e93\u6bd4\u5bf9\n    `blastx`             \u5c06\u6838\u9178\u5e8f\u5217\u7ffb\u8bd1\u6210\u86cb\u767d\u5e8f\u5217\u540e\u4e0e\u975e\u5197\u4f59(nr)\u86cb\u767d\u8d28\u6570\u636e\u5e93\u6bd4\u5bf9\n    `psitblastn`\n    `tblastn`\n    `tblastx`\n-d: \u6307\u5b9a\u8981\u8c03\u7528\u6570\u636e\u5e93\uff0c\u9ed8\u8ba4\u503c\u662f\u975e\u5197\u4f59(nr)\u6570\u636e\u5e93\u3002\u672c\u5730 Blast \u6bd4\u5bf9\u4e00\u822c\u6765\u8bf4\u90fd\u662f\u8c03\u7528 formatdb \u683c\u5f0f\u5316\u7684\u6570\u636e\u5e93\u3002\n-i: \u8f93\u5165\uff0c\u9ed8\u8ba4\u503c\u662f\u7ec8\u7aef\u8f93\u5165\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6bd4\u5982`-i seq.fasta`\n-o: \u8f93\u51fa\uff0c\u9ed8\u8ba4\u503c\u662f\u7ec8\u7aef\u6253\u5370\u8f93\u51fa\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6bd4\u5982`-o result.txt`\n-e: \u671f\u671b\u503c\u3002\n-T: \u8f93\u51fa\u6587\u4ef6\u683c\u5f0f\uff0c\u9ed8\u8ba4\u503c\u4e3aF(False)\uff0c\u60f3\u8f93\u51faHTML\u683c\u5f0f\u7684\u53ef\u4ee5\u7528`-T T`\n-M: \u77e9\u9635\u7b97\u6cd5\u9009\u62e9\uff0c\u9ed8\u8ba4\u503c\u662f`BLOSUM62`\n-n: \u5982\u679c\u60f3\u4f7f\u7528MegaBlast\uff0c\u5c31\u8bbe\u7f6e`-n T`\n-b: \u6570\u636e\u5e93\u4e2d\u7684\u6bd4\u5bf9\u7ed3\u679c\u663e\u793a\u6761\u76ee\u6570\uff0c\u9ed8\u8ba4\u662f250\u6761\u8bb0\u5f55\u3002\n-m: \u6bd4\u5bf9\u7ed3\u679c\u7684\u8f93\u51fa\u663e\u793a\u65b9\u5f0f\uff0c\u503c\u4e3a0~11\uff0c\u9ed8\u8ba4\u662f0\u3002\u5404\u4e2a\u6570\u5b57\u542b\u4e49\u89c1\u4e0b\u8868\u3002\n</code></pre> \u53c2\u6570 \u542b\u4e49 0 pairwise 1 query-anchored showing identities 2 query-anchored no identities 3 flat query-anchored, show identities 4 flat query-anchored, no identities 5 query-anchored no identities and blunt ends 6 flat query-anchored, no identities and blunt ends 7 XML Blast output 8 tabular 9 tabular with comment lines 10 ASN, text 11 ASN, binary [Integer] <p>\u5176\u4ed6\u53c2\u6570\u53c2\u89c1<code>man blast</code>\u3002</p> <p>\u5e94\u7528\u4e3e\u4f8b:</p> <p>Local blast\u4f8b\u5b50\uff1a</p> <pre><code># \u4f7f\u7528 custom_genome.fasta \u6587\u4ef6\u4f5c\u4e3a\u6570\u636e\u5e93\n# formatdb \u683c\u5f0f\u5316\u4f5c\u4e3a\u672c\u5730\u6570\u636e\u5e93\n$ formatdb -i custom_genome.fasta -o T -p F\n# \u4f7f\u7528 blastn \u5bf9 myseq.fasta \u5e8f\u5217\u8fdb\u884c\u6bd4\u5bf9\n$ blastall -i myseq.fasta -d custom_genome.fasta -p blastn\n</code></pre>"},{"location":"book/1.Raw_Data/04_blast/#32-blast","title":"3.2 Blast+","text":"<p>\u4e0b\u8f7d\u5b89\u88c5 NCBI Blast+</p> <pre><code># Ubuntu \u7cfb\u7edf\u4e2d\u5b89\u88c5 ncbi blast\n$ sudo apt install ncbi-blast+\n\n# Archlinux \u7cfb\u7edf\u4e2d\u5b89\u88c5 ncbi blast\n$ sudo pacman -S\n</code></pre> <p>\u6784\u5efa\u6570\u636e\u5e93</p> <pre><code># \u5c06\u5e8f\u5217\u6587\u4ef6 data/database.fasta \u683c\u5f0f\u5316\u6210\u6570\u636e\u5e93\n# \u6570\u636e\u7c7b\u578b\u4e3a\u6838\u9178\uff0c\u5219\u53c2\u6570\u4e3a -dbtype nucl\n$ makeblastdb -in data/database.fasta -dbtype nucl -parse_seqids\n</code></pre> <p>\u8fd0\u884c blast</p> <pre><code># \u4f7f\u7528 blastn \u7a0b\u5e8f\u6bd4\u5bf9 myseq.fasta \u5e8f\u5217\u3002\n$ blastn -query myseq.fasta -db data/database.fasta -out result.txt\n# \u5e38\u7528\u7b80\u5355\u8f93\u51fa\u65b9\u5f0f\n$ blastn -query myseq.fasta -db data/database.fasta -outfmt 6 -out result.txt\n</code></pre> <p>http://www.personal.psu.edu/iua1/courses/files/2014/lecture-12.pdf</p>"},{"location":"book/1.Raw_Data/04_blast/#4-blast-web","title":"4. \u6784\u5efa\u672c\u5730\u7684 blast web \u670d\u52a1","text":""},{"location":"book/1.Raw_Data/04_blast/#41-blastkit","title":"4.1 blastkit","text":"<p>blastkit \u662f\u4e00\u4e2a\u5305\u542bwebserver\u7b49\u5de5\u5177\u7684blast\u5de5\u5177\u96c6\u3002</p> <p>\u5b89\u88c5\u4f9d\u8d56\u5305</p> <pre><code>$ conda create -n blastkit\n$ conda activate blastkit\n(blastkit)$ pip install pygr\n(blastkit)$ pip install whoosh\n(blastkit)$ pip install git+https://github.com/ctb/pygr-draw.git\n(blastkit)$ pip install git+https://github.com/ged-lab/screed.git\n(blastkit)$ conda install lighttpd\n(blastkit)$ conda install blast-legacy\n</code></pre> <p>\u5bf9lighttpd webserver\u8fdb\u884c\u914d\u7f6e</p> <pre><code>$ cd /etc/lighttpd/conf-enabled\n$ sudo ln -fs ../conf-available/10-cgi.conf ./\n$ sudo echo 'cgi.assign = ( \".cgi\" =&gt; \"\" )' &gt;&gt; 10-cgi.conf\n$ sudo echo 'index-file.names += ( \"index.cgi\" ) ' &gt;&gt; 10-cgi.conf\n$ sudo /etc/init.d/lighttpd restart\n</code></pre> <pre><code>(prokka)$ conda install lighttpd\n(prokka)$ cd $HOME/.conda/etc/lighttpd/conf-enabled\n$ sudo ln -fs ../conf-available/10-cgi.conf ./\n$ sudo echo 'cgi.assign = ( \".cgi\" =&gt; \"\" )' &gt;&gt; 10-cgi.conf\n$ sudo echo 'index-file.names += ( \"index.cgi\" ) ' &gt;&gt; 10-cgi.conf\n$ lighttpd restart\n</code></pre> <p>\u5b89\u88c5 blastkit</p> <pre><code># \u514b\u9686\u8f6f\u4ef6\u4ed3\u5e93 blastkit\n$ git clone https://github.com/ctb/blastkit.git -b ec2\n$ cd blastkit/www\n# \u5c06www\u8def\u5f84\u94fe\u63a5\u5230 /var \u4e2d\n$ sudo ln -fs $PWD /var/www/blastkit\n# \u5efa\u7acb\u4e34\u65f6\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\n$ mkdir files\n$ chmod a+rxwt files\n#\n$ chmod +x /root\n$ cd ..\n# \u8fd0\u884c\u68c0\u6d4b\u811a\u672c\n$ python ./check.py\n\n#\u5982\u679c\u5b89\u88c5\u987a\u5229\uff0c\u5c31\u4f1a\u63d0\u793a\u4e00\u5207\u5df2\u7ecf\u51c6\u5907\u5b8c\u6bd5\u3002\u63a5\u4e0b\u6765\u8981\u51c6\u5907\u6570\u636e\u3002\n# \u5c06\u5927\u80a0\u57c3\u5e0c\u83ccDNA\u5e8f\u5217\u6587\u4ef6contigs.fa\u590d\u5236\u5230\u6570\u636e\u5e93\u76ee\u5f55\u4e0b\n$ cp ~/contigs.fa blastkit/db/db.fa\n# \u4f7f\u7528 formatdb \u683c\u5f0f\u5316\u6570\u636e\u5e93\n$ formatdb -i db/db.fa -o T -p F\n# \u5efa\u7acb\u7d22\u5f15\n$ python index-db.py db/db.fa\n</code></pre>"},{"location":"book/1.Raw_Data/04_blast/#reference","title":"Reference","text":"<ul> <li>Blastkit</li> <li>Caltech workshop</li> <li>Angus</li> </ul>"},{"location":"book/1.Raw_Data/05_fastqc/","title":"FastQC","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p>"},{"location":"book/1.Raw_Data/05_fastqc/#_1","title":"\u4f7f\u7528","text":"<pre><code>$ conda install fastqc\n</code></pre> <pre><code>$ fastqc 1_1.fastq.gz 1_2.fastq.gz\n</code></pre>"},{"location":"book/1.Raw_Data/06_multiqc/","title":"MultiQC","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>\u5185\u5bb9\u4ecb\u7ecd</p> <p>MultiQC \u662f\u4e00\u4e2a\u5c06\u6570\u636e\u8d28\u63a7\u7ed3\u679c\u6c47\u603b\u5e76\u751f\u6210\u62a5\u544a\u7684\u8f6f\u4ef6\u3002</p>"},{"location":"book/1.Raw_Data/06_multiqc/#_1","title":"\u5b89\u88c5","text":"<pre><code>$ conda create -n multiqc\n$ conda activate multiqc\n(multiqc)$ conda install multiqc qualimap fastqc snpeff gatk\n</code></pre>"},{"location":"book/1.Raw_Data/07_seqkit/","title":"Seqkit","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>Seqkit \u662f\u7531\u56fd\u4eba shenwei \u5f00\u53d1\uff0c\u529f\u80fd\u5f3a\u5927\u7684\u547d\u4ee4\u884c\u5e8f\u5217\u5904\u7406\u5de5\u5177\u5957\u4ef6\u3002</p>"},{"location":"book/1.Raw_Data/07_seqkit/#_1","title":"\u4f7f\u7528","text":"\u5b50\u547d\u4ee4 \u7528\u9014 common find common sequences of multiple files by id/name/sequence concat concatenate sequences with same ID from multiple files convert convert FASTQ quality encoding between Sanger, Solexa and Illumina duplicate duplicate sequences N times faidx create FASTA index file and extract subsequence fq2fa convert FASTQ to FASTA fx2tab convert FASTA/Q to tabular format (with length/GC content/GC skew) genautocomplete generate shell autocompletion script grep search sequences by ID/name/sequence/sequence motifs, mismatch allowed head print first N FASTA/Q records help Help about any command locate locate subsequences/motifs, mismatch allowed mutate edit sequence (point mutation, insertion, deletion) range print FASTA/Q records in a range (start:end) rename rename duplicated IDs replace replace name/sequence by regular expression restart reset start position for circular genome rmdup remove duplicated sequences by id/name/sequence sample sample sequences by number or proportion seq transform sequences (revserse, complement, extract ID...) shuffle shuffle sequences sliding sliding sequences, circular genome supported sort sort sequences by id/name/sequence/length split split sequences into files by id/seq region/size/parts (mainly for FASTA) split2 split sequences into files by size/parts (FASTA, PE/SE FASTQ) stats simple statistics of FASTA/Q files subseq get subsequences by region/gtf/bed, including flanking sequences tab2fx convert tabular format to FASTA/Q format translate translate DNA/RNA to protein sequence version print version information and check for update"},{"location":"book/1.Raw_Data/07_seqkit/#grep","title":"grep \u547d\u4ee4","text":"<p>spades \u7ec4\u88c5\u5b8c\u6bd5\u7684\u5e8f\u5217\uff0c\u63d0\u53d6\u5176\u4e2d\u67d0\u4e2a node \u6216\u8005\u67d0\u4e9b nodes \u5e8f\u5217\uff1a</p> <pre><code>$ seqkit grep -r -p ^node_1$ scaffolds.fasta &gt; node_1.fasta\n</code></pre> <p>\u5c06 scaffolds \u4e2d\u6240\u6709 nodes \u63d0\u53d6\u5230\u5355\u72ec\u7684 fasta \u6587\u4ef6\u4e2d\uff1a</p> <pre><code>$ for i in $(awk '/&gt;/' scaffolds.fasta | awk '{print $1}'); \\\n&gt; do seqkit grep -p ${i:1} scaffolds.fasta &gt; ${i:1}.fasta; \\\n&gt; done\n</code></pre>"},{"location":"book/1.Raw_Data/07_seqkit/#seq","title":"seq \u547d\u4ee4","text":"<pre><code>$ seqkit seq -h\n</code></pre> <p>```bash tab=\"-n\u548c-i\"</p>"},{"location":"book/1.Raw_Data/07_seqkit/#reads-bioawk-name-i","title":"\u5c06 reads \u7684\u540d\u79f0\u4fe1\u606f\u8f93\u51fa\uff0c\u5982\u679c\u8981\u548c bioawk $name \u76f8\u540c\uff0c\u4f7f\u7528 -i \u53c2\u6570","text":"<p>$ seqkit seq -n SRR1175124_1.fastq.gz SRR1175124_2.fastq.gz SRR1175124.102354 102354 length=150 ... $ bioawk -c fastx '{print $name}' SRR1175124_1.fastq.gz SRR1175124_2.fastq.gz SRR1175124.102354 ... $ seqkit seq -in SRR1175124_1.fastq.gz SRR1175124_2.fastq.gz SRR1175124.102354 ...</p>"},{"location":"book/1.Raw_Data/07_seqkit/#_2","title":"Seqkit","text":"<pre><code>```bash tab=\"-l\u548c-u\"\n# \u8f93\u51fa\u5c0f\u5199\u78b1\u57fa\n$ seqkit seq -sl SRR1175124_1.fastq.gz\n# \u8f93\u51fa\u5927\u5199\u78b1\u57fa\n$ seqkit seq -su SRR1175124_1.fastq.gz\n</code></pre>"},{"location":"book/1.Raw_Data/07_seqkit/#_3","title":"\u4f7f\u7528\u6848\u4f8b","text":"<pre><code># \u4e0b\u8f7d NC_001477\n$ efetch -db nuccore -id NC_001477 -format fasta &gt; NC_001477.fasta\n# \u7ffb\u8bd1 DNA \u5e8f\u5217\u4e3a\u6c28\u57fa\u9178\u5e8f\u5217\n$ seqkit translate -j 4 -o NC_001477.pep NC_001477.fasta\n#\n</code></pre> <p>\u5bf9\u6ce8\u91ca\u7684\u591a\u62f7\u8d1d\u57fa\u56e0\u63d0\u53d6\u5e8f\u5217\u540e\u8fdb\u884c\u5e8f\u5217\u6bd4\u5bf9</p> <pre><code># \u7528prokka\u6ce8\u91ca\u57fa\u56e0\u7ec4\u62fc\u63a5\u5e8f\u5217\n$ prokka --rfam --prefix sample --outdir sample contig.fa\n# \u7528 seqkit \u63d0\u53d6\u591a\u62f7\u8d1d\u57fa\u56e0 ncRNA Qrr \u7684\u5e8f\u5217\n$ grep 'Qrr' sample/sample.gff | for i in $(awk '{print $9}'); do seqkit grep -p ${i:3:14} sample.ffn &gt;&gt; qrr.fa; done\n# mafft \u5e8f\u5217\u6bd4\u5bf9\n$ mafft qrr.fa &gt; qrr.mafft\n# raxml \u5feb\u901f\u6784\u5efa\u8fdb\u5316\u6811\n$ raxmlHPC -f a -p 12345 -x 12345 -# 1000 -m GTRGAMMA -s qrr.mafft -n qrr\n</code></pre>"},{"location":"book/1.Raw_Data/08_trimmomatic/","title":"\u4e8c\u4ee3\u6570\u636e\u7684trim\u64cd\u4f5c","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p>"},{"location":"book/1.Raw_Data/08_trimmomatic/#trimmomatic","title":"trimmomatic","text":"<p>trim and filt</p> <p>\u8f6f\u4ef6\u7248\u672c: v</p> <pre><code>$ trimmomatic PE -threads 4 SRR_1056_1.fastq SRR_1056_2.fastq  \\\n&gt; SRR_1056_1.trimmed.fastq SRR_1056_1un.trimmed.fastq \\\n&gt; SRR_1056_2.trimmed.fastq SRR_1056_2un.trimmed.fastq \\\n&gt; ILLUMINACLIP:SRR_adapters.fa SLIDINGWINDOW:4:20\n</code></pre>"},{"location":"book/2.To_Genome/01_bwa-samtools-pipeline/","title":"bwa + samtools \u57fa\u672c\u5206\u6790\u6d41\u7a0b","text":"<p>{{ git_page_authors() }} \u66f4\u65b0\u4e8e: {{ git_revision_date() }}</p> <p>\u53ef\u4ee5\u91c7\u7528\u57fa\u4e8e\u6bd4\u5bf9\u7684\u65b9\u6cd5\u83b7\u5f97\u53c2\u8003\u57fa\u56e0\u7ec4 consensus \u5e8f\u5217\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5e94\u7528\u5728\u75c5\u6bd2\u7b49\u57fa\u56e0\u7ec4\u5e8f\u5217\u7684\u83b7\u5f97\u3002</p> <ul> <li>\u6bd4\u5bf9\u8f6f\u4ef6: bwa</li> <li>BAM\u8f6f\u4ef6: samtools</li> <li>\u53bb\u91cd\u590d: gatk4 MarkDuplicates</li> <li>\u751f\u6210vcf: freebayes</li> <li>\u6ce8\u91cavcf: snpEff</li> </ul>"},{"location":"book/2.To_Genome/01_bwa-samtools-pipeline/#_1","title":"\u547d\u4ee4\u64cd\u4f5c","text":"<pre><code># \u5bf9 fasta \u683c\u5f0f\u7684\u53c2\u8003\u5e8f\u5217 ref.fa \u5efa\u7acb\u7d22\u5f15\n$ bwa index ref.fa\n\n# \u5229\u7528 mem \u7b97\u6cd5\u5c06 illumina reads \u6bd4\u5bf9\u5230\u53c2\u8003\u57fa\u56e0\u7ec4\u4e0a\n# \u5e76\u4f7f\u7528 samtools \u5c06\u5176\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236 bam \u4e2a\u662f\u6587\u4ef6\n$ bwa mem -t 40 ref.fa -R \"@RG\\tID:1\\tSM:S1\" 1_S1_L001_R1.fastq.gz 1_S1_L001_R2.fastq.gz | \\\n&gt; samtools view -bS &gt; 1.bam\n\n# \u5c06 bam \u6587\u4ef6\u6392\u5e8f\n$ samtools sort -O bam 1.sorted.bam 1.bam\n\n# \u4f7f\u7528 gatk \u53bb\u9664\u91cd\u590d\u9700\u91cc\n$ gatk MarkDuplicates -I 1.sorted.bam -O 1.markdup.sorted.bam -M 1.markdup.sorted_metrics.txt\n\n# \u5bf9\u6392\u5e8f\u5e76\u53bb\u91cd\u590d\u7684\u5e8f\u5217\u5efa\u7acb\u7d22\u5f15\n$ samtools index 1.markdup.sorted.bam\n\n# \u4f7f\u7528 freebayes \u5c06 bam \u683c\u5f0f\u7684\u7ed3\u679c\u8f6c\u6362\u4e3a vcf \u683c\u5f0f\u7684\u6587\u4ef6\n$ freebayes -m 20 -p 1 -f ref.fa 1.markdup.sorted.bam &gt; 1.vcf\n\n# \u4f7f\u7528 snpEff \u83b7\u5f97 SNP \u4e3a\u70b9\u6ce8\u91ca\n$ snpEff lmo_database 1.vcf &gt; 1.snpEff.vcf\n</code></pre>"},{"location":"book/2.To_Genome/01_bwa-samtools-pipeline/#reference","title":"Reference","text":"<p>BWA\u4e2d\u6587\u624b\u518c</p>"},{"location":"book/2.To_Genome/02_bacteria-assembly/","title":"\u7ec6\u83cc\u57fa\u56e0\u7ec4\u77ed\u5e8f\u5217\u62fc\u63a5\u62fc\u63a5","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>\u5fae\u751f\u7269\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u540e\u7684\u62fc\u63a5\u5de5\u4f5c\uff0c\u6709\u8bb8\u591a\u8f6f\u4ef6\u53ef\u4ee5\u5b8c\u6210\u3002\u8fd1\u51e0\u5e74\u4e0d\u65ad\u6709\u65b0\u7684\u4f18\u79c0\u62fc\u63a5\u8f6f\u4ef6\u6d8c\u73b0\uff0c\u672c\u8282\u4ec5\u6311\u9009\u51e0\u4e2a\u5fae\u751f\u7269\u57fa\u56e0\u7ec4\u62fc\u63a5\u4f7f\u7528\u8f83\u591a\u4e5f\u662f\u8bc4\u6d4b\u4e2d\u6bd4\u8f83\u4f18\u79c0\u7684\u51e0\u4e2a\u5de5\u5177\u3002\u4e5f\u53ef\u4ee5\u5148\u5bf9\u81ea\u5df1\u7684\u6d4b\u5e8f\u7269\u79cd\u505a\u4e00\u4e2a assembly evaluation\uff0c\u9009\u62e9\u6bd4\u8f83\u9002\u5408\u7684\u62fc\u63a5\u8f6f\u4ef6\u3002</p> <p>\u5e38\u7528\u62fc\u63a5\u8f6f\u4ef6\u5de5\u5177\u5217\u8868</p> <ul> <li><code>SPAdes &lt;http://spades.bioinf.spbau.ru/&gt;</code>_</li> <li><code>MaSuRCA &lt;http://www.genome.umd.edu/masurca.html&gt;</code>_</li> <li><code>Velvet</code></li> <li><code>A5_miseq</code></li> </ul> <p>\u66f4\u591a\u5de5\u5177\u53ef\u4ee5\u53c2\u89c1<code>\u8fd9\u91cc &lt;https://omictools.com/genome-assembly-category&gt;</code>_</p>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#1-spades","title":"1. SPAdes","text":"<p>SPAdes \u662f\u7531</p>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#11-spades","title":"1.1 \u5b89\u88c5 SPAdes","text":"<p>\u901a\u8fc7conda\u5b89\u88c5</p> <pre><code>$ conda create -n spades\n$ conda activate spades\n(assembly)$ conda install spades\n</code></pre> <p>Docker\u65b9\u5f0f\u5b89\u88c5</p> <pre><code>$\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#12-spades","title":"1.2 \u4f7f\u7528 spades \u62fc\u63a5\u4e8c\u4ee3\u7ec6\u83cc\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e","text":"<pre><code># \u4ee5SRR95386 \u4e3a\u4f8b\n$ prefetch SRR956386\n$ fastq-dump --split-e --gzip SRR956386.sra\n# -t 40 \u8868\u793a\u752840\u4e2a threads \u8fdb\u884c\u62fc\u63a5\uff0c\u6839\u636e\u81ea\u5df1\u7535\u8111\u7684CPU\u60c5\u51b5\u81ea\u884c\u8bbe\u7f6e\u3002\n$ spades.py --careful -k 21,33,55,77,99,121 -1 SRR95386_1.fastq -2 SRR955386_2.fastq \\\n&gt; -o spades_output -t 40\n</code></pre> <p>SPAdes\u4f1a\u6839\u636e <code>-k</code> \u53c2\u6570\u9009\u62e9\u4e0d\u540c\u7684 Kmer \u8fdb\u884c de novo \u7ec4\u88c5\u3002\u5bf9\u4e8e\u5e38\u89c1\u7684 Miseq v2/v3 \u8bd5\u5242\u76d2\uff0c\u91c7\u7528 PE150/PE250/PE300 \u7684\u8bfb\u957f\u6d4b\u5e8f\uff0c\u5e38\u7528\u7684\u62fc\u63a5\u547d\u4ee4\u662f\uff1a</p> <pre><code># PE150 \u8bfb\u957f\u6d4b\u5e8f\u6570\u636e\n$ spades.py -k 21,33,55,77 --careful -1 SRR95386_1.fastq -2 SRR955386_2.fastq -o SRR95386_output -t 40\n# PE250/300 \u8bfb\u957f\u6d4b\u5e8f\u6570\u636e\n$ spades.py -k 21,33,55,77,99,127 --careful -1 SRR95386_1.fastq -2 SRR955386_2.fastq -o SRR95386_output -t 40\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#2-macursa","title":"2. Macursa","text":""},{"location":"book/2.To_Genome/02_bacteria-assembly/#21-masurca","title":"2.1 \u5b89\u88c5 MaSuRCA","text":"<pre><code>$ conda create -n masurca\n$ conda activate masurca\n(masurac)$ conda install masurca\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#22","title":"2.2 \u5efa\u7acb\u62fc\u88c5\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>$ touch SRR955386_masurca.config\n$ vim SRR955386_masurca.config\n</code></pre> <p>\u6587\u4ef6\u5185\u5bb9\u4fee\u6539\u5982\u4e0b\uff1a</p> <pre><code>DATA\nPE= p1 500 50 SRR955386_1.fastq SRR955386_2.fastq\nEND\n\nPARAMETERS\nGRAPH_KMER_SIZE=auto\nUSE_LINKING_MATES=1\nLIMIT_JUMP_COVERAGE = 60\nKMER_COUNT_THRESHOLD = 1\nNUM_THREADS= 2\nJF_SIZE=100000000\nDO_HOMOPOLYMER_TRIM=0\nEND\n</code></pre> <p>\u8bbe\u7f6e GRAPH_KMER_SIZE=auto\uff0c\u8f6f\u4ef6\u4f1a\u8c03\u7528Kmer=31\u6765\u8fdb\u884c\u62fc\u88c5\u3002\u5bf9\u4e8eMiSeq PE250\u4ee5\u4e0a\u7684\u63d2\u7247\uff0c\u53ef\u4ee5\u8003\u8651\u624b\u52a8\u8bbe\u7f6e\u4f7f\u7528\u66f4\u5927\u7684Kmer\u3002</p>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#23","title":"2.3 \u5f00\u59cb\u62fc\u88c5","text":"<pre><code># \u8fd0\u884c masurca\n$ masurca SRR955386_masurca.config\n# \u751f\u6210\u7ec4\u88c5\u811a\u672c\uff0c\u8fd0\u884c\n$ ./assemble.sh\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#3-velvet","title":"3. Velvet","text":""},{"location":"book/2.To_Genome/02_bacteria-assembly/#31","title":"3.1 \u4e0b\u8f7d\u5e76\u5b89\u88c5","text":"<p>Velvet \u662f\u4e00\u4e2a\u8001\u724c\u7684\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u62fc\u63a5\u8f6f\u4ef6\u3002Velvet\u6700\u65b0\u7248\u672c\u662f1.2.10\uff0c\u53ef\u4ee5\u8bbf\u95ee <code>\u5b98\u65b9\u7f51\u7ad9 &lt;https://www.ebi.ac.uk/~zerbino/velvet/&gt;</code>_ \u4e0b\u8f7d\u6e90\u4ee3\u7801\u5305\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u514b\u9686 <code>\u8f6f\u4ef6\u4ed3\u5e93 &lt;https://github.com/dzerbino/velvet.git&gt;</code>_ \u7684\u65b9\u5f0f\u83b7\u5f97\u6700\u65b0\u7684\u6e90\u4ee3\u7801\u3002</p> <p>\u4e0b\u8f7d\u6e90\u4ee3\u7801</p> <p>\u666e\u901a\u7528\u6237\u53ef\u4ee5\u4e0b\u8f7d\u6e90\u4ee3\u7801\u5305\u81ea\u884c\u7f16\u8bd1\u83b7\u5f97\u8f6f\u4ef6\u3002</p> <pre><code>$ cd /tmp\n$ wget https://www.ebi.ac.uk/~zerbino/velvet/velvet_1.2.10.tgz\n$ tar xvf velvet_1.2.10.tgz -C ~/app/velvet\n</code></pre> <p>\u514b\u9686\u4ee3\u7801\u4ed3\u5e93</p> <p>\u5982\u679c\u5728\u8f6f\u4ef6\u8fd0\u884c\u4e2d\u9047\u5230\u95ee\u9898\uff0c\u60f3\u8bd5\u7528\u6700\u65b0\u7248\u4ee3\u7801\uff0c\u6216\u662f\u6709\u80fd\u529b\u63d0\u4ea4issues\uff0c\u6216\u8005\u60f3\u6539\u8fdb\u8f6f\u4ef6\u53c2\u4e0e\u5f00\u6e90\u4ee3\u7801\u7f16\u5199\u7684\u53ef\u4ee5\u9009\u62e9\u514b\u9686\u4ee3\u7801\u5e93\u7684\u65b9\u5f0f\u3002</p> <pre><code>$ cd ~/tmp\n$ git clone https://github.com/dzerbino/velvet.git\n</code></pre> <p>\u7f16\u8bd1\u5b89\u88c5</p> <p>make\u53ef\u4ee5\u8fdb\u884c\u7f16\u8bd1\uff0c\u6709\u51e0\u4e2a\u7f16\u8bd1\u53c2\u6570\u53ef\u4ee5\u9009\u62e9\uff0c\u5206\u522b\u662fMAXKMERLENGTH, DIRECTORY</p> <p>.. code-block:: bash</p> <p>~$ cd ~/app/velvet    ~/app/velvet$ make 'MAXKMERLENGTH=127'    ~/app/velvet$ sudo cp velveth velvetg /usr/local/sbin</p>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#32","title":"3.2 \u62fc\u63a5\u57fa\u56e0\u7ec4","text":"<p>velvet\u8f6f\u4ef6\u75312\u4e2a\u53ef\u6267\u884c\u6587\u4ef6 <code>velveth</code> \u548c <code>velvetg</code> \u7ec4\u6210\u3002</p> <pre><code>$ velvet\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#4-a5-miseq","title":"4. A5-miseq","text":"<p><code>A5-miseq &lt;https://sourceforge.net/projects/ngopt/&gt;</code>__ \u662f\u4e00\u4e2a\u7528 perl \u5f00\u53d1\u7684\u9488\u5bf9\u7ec6\u83cc\u57fa\u56e0\u7ec4 de novo assembly \u7684 pipeline \u5de5\u5177\u3002\u5b83\u672c\u8eab\u4e0d\u53c2\u4e0e\u7ec4\u88c5\uff0c\u800c\u662f\u901a\u8fc7\u7ec4\u5408\u4e00\u5957\u5de5\u5177\u6765\u5b8c\u6210\u5de5\u4f5c\uff0c\u5de5\u5177\u96c6\u5305\u62ec\uff1a</p> <ul> <li>bwa</li> <li>samtools</li> <li>SGA</li> <li>bowtie</li> <li>Trimmomatic</li> <li>IDBA-UD</li> <li>SSPACE</li> </ul> <p>\u8fd9\u4e9b\u5de5\u5177\u90fd\u4ee5\u53ca\u96c6\u6210\u5728 A5-miseq \u4e2d\uff0c\u4e0d\u9700\u8981\u53e6\u5916\u5b89\u88c5\u3002\u4e3a\u4e86\u907f\u514d\u4e0d\u540c\u7248\u672c\u7684 samtools\uff0cbowtie \u5bf9\u7ed3\u679c\u4ea7\u751f\u7684\u5dee\u5f02\uff0c\u5efa\u8bae\u91c7\u7528\u865a\u62df\u73af\u5883\u5982 docker \u7b49\u6765\u9694\u79bb\u8fd0\u884c\u73af\u5883\u3002</p>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#41-a5-miseq","title":"4.1 \u5b89\u88c5 A5-miseq","text":"<p>\u4e0b\u8f7d\u9884\u7f16\u8bd1\u5305\u5b89\u88c5</p> <pre><code>$ wget http://downloads.sourceforge.net/project/ngopt/a5_miseq_linux_20150522.tar.gz\n$ tar zxvf a5_miseq_linux_20150522.tar.gz -C ~/app\n$ sudo ln -s ~/app/a5_miseq_linux_20150522/bin/a5_pipeline.pl /usr/local/sbin\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#docker","title":"\u5efa\u7acb Docker \u5bb9\u5668\u5b89\u88c5","text":"<pre><code>FROM ubuntu:latest\nMAINTAINER Mark Renton &lt;indexofire@gmail.com&gt;\n\nRUN apt-get update -qy\nRUN apt-get install -qy openjdk-7-jre-headless file\nADD http://downloads.sourceforge.net/project/ngopt/a5_miseq_linux_20150522.tar.gz /tmp/a5_miseq.tar.gz\nRUN mkdir /tmp/a5_miseq\nRUN tar xzf /tmp/a5_miseq.tar.gz --directory /tmp/a5_miseq --strip-components=1\nADD run /usr/local/bin/\nADD Procfile /\nENTRYPOINT [\"/usr/local/bin/run\"]\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#42-a5-miseq","title":"4.2 \u4f7f\u7528 A5-miseq","text":"<pre><code>$ perl a5_pipeline.pl SRR955386_1.fastq SRR955386_2.fastq ~/data/a5_output\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#43-a5-miseq","title":"4.3 A5-miseq \u6587\u6863","text":"<p>\u67e5\u770b A5-miseq \u5de5\u5177\u7684\u4f7f\u7528\u6587\u6863\u53ef\u4ee5\u7528 a5_pipeline.pl \u5de5\u5177\u67e5\u770b\u3002</p> <pre><code># Usage:\n$ a5_pipeline.pl [--begin=1-5] [--end=1-5] [--preprocessed] &lt;lib_file&gt; &lt;out_base&gt;\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#5shovill","title":"5.Shovill","text":"<p>Shovill \u662f\u4e00\u4e2a\u7b2c\u4e09\u65b9\u7ec4\u88c5\u6d41\u7a0b\uff0c\u5b83\u8c03\u7528spades\u6216velvet\u7b49\u8f6f\u4ef6\u8fdb\u884c\u62fc\u63a5\uff0c\u751f\u6210\u9002\u7528\u4e8e\u7ec6\u83cc\u57fa\u56e0\u7ec4\u7ec4\u88c5\u7684\u7ed3\u679c\u3002</p>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#51","title":"5.1 \u5b89\u88c5","text":"<pre><code>$ conda create -n shovill\n$ conda activate shovill\n(shovill)$ conda install shovill\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#52","title":"5.2 \u4f7f\u7528","text":"<pre><code>(shovill)$ shovill --R1 --R2\n</code></pre>"},{"location":"book/2.To_Genome/02_bacteria-assembly/#reference","title":"Reference:","text":"<ul> <li>http://www.chenlianfu.com/?p=1635</li> <li>http://www.bbioo.com/lifesciences/40-116878-1.html</li> <li>http://www.plob.org/2012/11/21/4797.html</li> <li>http://ged.msu.edu/angus/tutorials-2011/short-read-assembly-velvet.html</li> </ul>"},{"location":"book/3.Genome_Annotation/01_prokka/","title":"Prokka","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>Prokka \u662f\u4e00\u4e2a\u539f\u6838\u7269\u79cd\u57fa\u56e0\u7ec4\u6ce8\u91ca\u5de5\u5177\uff0c\u7531\u58a8\u5c14\u672c\u5927\u5b66\u751f\u7269\u4fe1\u606f\u5b66\u5bb6 Torsten Seemann \u5f00\u53d1\u7684\u57fa\u4e8e\u547d\u4ee4\u884c\u7684\u672c\u5730\u5feb\u901f\u6ce8\u91ca\u5de5\u5177\uff0c\u7528\u6765\u6ce8\u91ca\u5c0f\u57fa\u56e0\u7ec4\u6bd4\u5982\u7ec6\u83cc\u3001\u75c5\u6bd2\u7b49\u975e\u5e38\u65b9\u4fbf\u3001\u5feb\u901f\u3002</p>"},{"location":"book/3.Genome_Annotation/01_prokka/#prokka_1","title":"\u5b89\u88c5 Prokka","text":""},{"location":"book/3.Genome_Annotation/01_prokka/#1","title":"1.\u4e0b\u8f7d\u5b89\u88c5","text":"<p>\u5982\u679c\u4e0b\u8f7d\u9884\u7f16\u8bd1\u5305\u5b89\u88c5\u7684\u8bdd\uff0c\u9700\u8981\u6709Bioperl\u652f\u6301\u3002\u4ee5\u53ca\u4e00\u4e9b\u7b2c\u4e09\u65b9\u5e93\u548c\u8f6f\u4ef6\u7684\u652f\u6301\u3002</p> <pre><code># \u5b89\u88c5 Bioperl\n$ sudo apt-get install cpanminus\n$ cpanm Bio::Perl XML::Simple\n\n# \u5b89\u88c5\u5176\u4ed6\u4f9d\u8d56\n$ sudo apt-get install libdatetime-perl libxml-simple-perl libdigest-md5-perl git default-jre bioperl\n\n# \u5b89\u88c5 rRNA \u6ce8\u91ca\u529f\u80fd\n# \u8fd9\u91cc\u9009\u62e9 Barrnap \u548c MINCED\n$ wget http://www.vicbioinformatics.com/barrnap-0.6.tar.gz\n$ tar zxvf barrnap-0.5.tar.gz -C ~/app/\n$ echo \"export PATH=$PATH:$HOME/app/barrnap-0.6/bin\" &gt;&gt; ~/.bashrc\n$ source ~/.bashrc\n$ wget https://github.com/ctSkennerton/minced/releases/download/0.3.0/minced\n$ sudo cp minced /usr/local/sbin\n\n# \u5b89\u88c5 ncRNA \u6ce8\u91ca\u529f\u80fd**\n# \u4f7f\u7528 infernal\n$ wget http://eddylab.org/infernal/infernal-1.1.2.tar.gz\n$ tar zxvf infernal-1.1.2.tar.gz -C ~/app/\n$ echo \"export PATH=$PATH:$HOME/app/infernal-1.1.2\"\n\n# \u5b89\u88c5 prokka\n$ wget http://www.vicbioinformatics.com/prokka-1.12.tar.gz\n$ tar zxvf prokka-1.12.tar.gz -C ~/app\n$ echo \"export PATH=$PATH:$HOME/app/prokka-1.12/bin\" &gt;&gt; ~/.bashrc\n$ source ~/.bashrc\n$ prokka --setupdb\n</code></pre> <p>\u6ce8\u610f\u4e8b\u9879</p> <p>\u5982\u679c\u8981\u4f7f\u7528 --gram \u529f\u80fd\uff0c\u9700\u8981\u5b89\u88c5 signalp\u3002signalp \u662f DTU \u5927\u5b66\u751f\u7269\u53ca\u536b\u751f\u4fe1\u606f\u5b66\u7cfb\u5f00\u53d1\uff0c\u652f\u6301web\u754c\u9762\u7684\u5de5\u5177\u3002\u547d\u4ee4\u884c\u7248\u672c\u9700\u8981\u63d0\u4f9b\u975e\u5546\u4e1aISP\u63d0\u4f9b\u7684\u90ae\u7bb1\u5e10\u53f7\u6ce8\u518c\u4ee5\u540e\u624d\u80fd\u4e0b\u8f7d\uff08\u6bd4\u5982\u653f\u5e9c\u6216\u5927\u5b66\uff09\u3002\u70b9\u51fb\u8fd9\u91cc\u3002</p>"},{"location":"book/3.Genome_Annotation/01_prokka/#2-conda","title":"2. conda \u5b89\u88c5","text":"<pre><code># \u521b\u5efa conda \u865a\u62df\u73af\u5883\n$ conda create -n prokka\n$ conda activate prokka\n(prokka)$ conda install prokka=1.14\n</code></pre>"},{"location":"book/3.Genome_Annotation/01_prokka/#prokka_2","title":"\u4f7f\u7528 Prokka","text":"<p>Prokka \u7684\u4f7f\u7528\u975e\u5e38\u7b80\u5355\uff0c\u51c6\u5907\u597d\u9700\u8981\u6ce8\u91ca\u7684\u6838\u9178\u5e8f\u5217fasta\u683c\u5f0f\u6587\u4ef6\u5373\u53ef\u3002\u8fd9\u91cc\u7528*Listeria monocytogenes*\u7684\u53c2\u8003\u57fa\u56e0\u7ec4egd\u4e3a\u4f8b\u3002</p> <pre><code># \u4e0b\u8f7d\u57fa\u56e0\u7ec4\u6570\u636e\n(prokka)$ esearch -db nuccore -query \"1639[txid] AND egd\" | efetch -format fasta &gt; egd.fasta\n\n# \u6ce8\u91ca\u57fa\u56e0\u7ec4\u5e8f\u5217\n(prokka)$ prokka egd.fasta\n</code></pre> <p><code>--listdb</code> \u53c2\u6570\u53ef\u4ee5\u67e5\u770b prokka \u6570\u636e\u5e93\u4fe1\u606f\u3002</p> <pre><code># \u67e5\u770b\u53ef\u4ee5\u4f7f\u7528\u7684\u6570\u636e\u5e93\n(prokka)$ prokka --listdb\n\nLooking for databases in: ...\n* Kingdoms: Archaea Bacteria Mitochondria Viruses\n* Genera: Enterococcus Escherichia Staphylococcus\n* HMMs: HAMAP\n* CMs: Bacteria Viruses\n</code></pre> <p>\u5982\u679c\u9700\u8981\u6bd4\u8f83\u5b8c\u6574\u7684\u8fdb\u884c\u5e8f\u5217\u6ce8\u91ca\uff0c\u7ed3\u679c\u53ef\u4ee5\u6bd4\u8f83\u65b9\u4fbf\u7684\u7528\u6765\u63d0\u4ea4\u7684\u8bdd\uff0c\u53ef\u4ee5\u6dfb\u52a0\u76f8\u5e94\u7684\u53c2\u6570\u6765\u89c4\u8303\u6ce8\u91ca\u4ee5\u53ca\u8c03\u7528\u4e0d\u540c\u7684\u5de5\u5177\u626b\u63cfncRNA\u7b49\u3002</p> <pre><code># \u6ce8\u91ca Listeria monocytogenes \u6807\u51c6\u682a egd\n(prokka)$ prokka --outdir egd --prefix egd --addgenes \\\n&gt; --addmrna --compliant --centre CDC --genus Listeria \\\n&gt; --species \"Listeria monocytogenes\" --strain egd \\\n&gt; --kingdom Bacteria --usegenus --cpus 4 --rfam \\\n&gt; --rnammer --force egd.fasta\n</code></pre> <p>\u751f\u6210\u7ed3\u679c\u6ce8\u91ca\u6587\u4ef6</p> <p>|----|----| | egd.err | prokka \u5bf9\u6ce8\u91ca\u7ed3\u679c\u5b58\u5728\u7684\u4e00\u4e9b\u7591\u95ee\u8fdb\u884c\u62a5\u544a\u7684\u4fe1\u606f | | egd.faa | \u6ce8\u91ca\u7684\u6c28\u57fa\u9178\u5e8f\u5217 | | egd.ffn | \u6ce8\u91ca\u7684\u78b1\u57fa\u5e8f\u5217 | | egd.fna | \u4ee5 NCBI gnl|centre| \u4e3aID\u547d\u540d\u7684\u78b1\u57fa\u5e8f\u5217\u6587\u4ef6 | | egd.fsa | \u4ee5 NCBI gnl|centre| \u4e3aID\u547d\u540d\u7684\u78b1\u57fa\u5e8f\u5217\u6587\u4ef6 | | egd.gbk | genbank \u683c\u5f0f\u7684\u6ce8\u91ca\u6587\u4ef6 | | egd.gff | gff \u683c\u5f0f\u7684\u6ce8\u91ca\u6587\u4ef6 | | egd.log | prokka \u8fd0\u884c\u65e5\u5fd7 | | egd.sqn | sqn \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u7528\u6765\u63d0\u4ea4\u5230 NCBI | | egd.tbl | tbl \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u7528\u6765\u63d0\u4ea4\u5230 NCBI | | egd.tsv | tsv \u683c\u5f0f\u6587\u4ef6\uff0c\u6ce8\u91ca\u57fa\u56e0\u7684\u5217\u8868 | | egd.txt | prokka \u6ce8\u91ca\u7684\u5404\u79cd\u7c7b\u578b\u5e8f\u5217\u7edf\u8ba1\u4fe1\u606f |</p> <p>--kingdom</p> <p>\u9ed8\u8ba4\u6ce8\u91ca\u7684\u662f\u7ec6\u83cc\u57fa\u56e0\u7ec4\uff0c\u5982\u679c\u662f\u5176\u4ed6\u7269\u79cd\u5219\u5efa\u8bae\u6dfb\u52a0\u7269\u79cd\u53c2\u6570\u3002\u53ef\u9009\u9879\u6709\uff1a</p> <ul> <li>Archaea: \u771f\u83cc</li> <li>Bacteria: \u7ec6\u83cc</li> <li>Mitochondria: \u7ebf\u7acb\u4f53</li> <li>Viruses: \u75c5\u6bd2</li> </ul> <p>\u5982\u679c\u8981\u6ce8\u91ca\u75c5\u6bd2\u57fa\u56e0\u7ec4\uff0c\u9664\u4e86\u6dfb\u52a0<code>--kingdom</code>\u5916</p> <pre><code>(prokka)$ prokka --kingdom Viruses contigs.fasta\n</code></pre> <p>.err \u6587\u4ef6</p> <p>err \u6587\u4ef6\u8bb0\u5f55\u4e86\u6ce8\u91ca\u8fc7\u7a0b\u4e2d\u7684\u53cd\u9988\u65e5\u5fd7\u3002</p> <p>.tsv \u6587\u4ef6</p> <p>tsv \u6587\u4ef6\u6309\u7167 locus_tag \u987a\u5e8f\u6392\u5e8f\u4e86\u6ce8\u91ca\u7684\u7ed3\u679c\u3002</p> <pre><code># \u663e\u793a tsv \u5185\u5bb9\n(prokka)$ head egd.tsv | column -t\n\nlocus_tag       ftype   length_bp       gene    EC_number       COG     product\nDJECODEN_00001  CDS     1356            dnaA            COG0593 Chromosomal replication initiator protein DnaA\nDJECODEN_00001  gene    1356            dnaA\nDJECODEN_00001  mRNA    1356            dnaA\nDJECODEN_00002  CDS     1146            dnaN            COG0592 Beta sliding clamp\nDJECODEN_00002  gene    1146            dnaN\nDJECODEN_00002  mRNA    1146            dnaN\nDJECODEN_00003  CDS     1344            yeeO_1          COG0534 putative FMN/FAD exporter YeeO\nDJECODEN_00003  gene    1344            yeeO_1\nDJECODEN_00003  mRNA    1344            yeeO_1\n</code></pre> <p>tsv\u6ce8\u91ca\u6587\u4ef6\u53ef\u4ee5\u770b\u5230\u6ce8\u91cagene\u540d\u79f0\uff0c\u957f\u5ea6\uff0c\u529f\u80fd\uff0c\u5bf9\u5e94\u7684EC\u3001COG\u4fe1\u606f\uff0c\u4ee5\u53ca\u6ce8\u91ca\u7684\u552f\u4e00\u6027\u7f16\u53f7\uff1a</p> <ul> <li>locus_tag: \u6ce8\u91ca\u57fa\u56e0\u7684 locus \u540d\u79f0</li> <li>ftype: \u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3aCDS\uff0c\u5982\u679c\u6253\u5f00--addgenes\u548c--addmrna\u53c2\u6570\uff0c\u5219\u4f1a\u533a\u522b\u662fRNA\u8fd8\u662f\u7f16\u7801\u57fa\u56e0</li> <li>length_bp: \u5e8f\u5217\u957f\u5ea6</li> <li>gene: \u6839\u636e\u6570\u636e\u5e93\u6ce8\u91ca\u5bf9\u5e94\u7684\u57fa\u56e0\u540d\u79f0\uff0c\u5982\u679c\u662f\u591a\u62f7\u8d1d\uff0c\u5219\u7528_1,_2\u7b49\u533a\u5206</li> <li>EC_number: \u57fa\u56e0\u5bf9\u5e94\u7684 EC \u503c</li> <li>COG: \u57fa\u56e0\u5bf9\u5e94\u7684COG</li> <li>product: \u57fa\u56e0\u7f16\u7801\u7684\u86cb\u767d\u8d28\u4ea7\u7269</li> </ul>"},{"location":"book/3.Genome_Annotation/01_prokka/#_1","title":"\u5e94\u7528\u793a\u4f8b","text":"<pre><code># \u6279\u91cf\u6ce8\u91ca\u57fa\u56e0\u7ec4\n(prokka)$ find . -name *.fna | sed 's/\\.fna//g' | \\\n&gt; parallel --max-args=1 prorkka --outdir prokka/{1} --prefix {1} \\\n&gt; --addgenes --addmrna --mincontiglen 200 --centre 'HZCDC' \\\n&gt; --proteins ref.gbk --rnammer --rfam {1}.fna\n\n# \u6ce8\u91ca\u5b8f\u57fa\u56e0\u7ec4\n(prokka)$ prokka --metagenome --outdir meta contigs.fa\n\n# \u5c06\u6ce8\u91caCDS\u957f\u5ea6\u6392\u5e8f\n(prokka)$ awk '/CDS/ {print $0}' egd.tsv | sort -kn3 -r | less\n\n# \u663e\u793a\u6240\u6709\u7684\u4e0d\u91cd\u590d\u6ce8\u91ca\u4ea7\u7269\n(prokka)$ awk '!a[$1]++{print}' egd.tsv\n\n# \u663e\u793a\u6240\u6709COG\u6ce8\u91ca\n(prokka)$ awk '/COG/' egd.tsv\n</code></pre>"},{"location":"book/3.Genome_Annotation/01_prokka/#reference","title":"Reference","text":""},{"location":"book/3.Genome_Annotation/02_eggnog/","title":"EggNOG","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <ul> <li>EggNOG</li> <li>EggNOG-mapper</li> </ul>"},{"location":"book/3.Genome_Annotation/02_eggnog/#eggnog-mapper","title":"\u672c\u5730\u5b89\u88c5 EggNOG-mapper","text":"<pre><code># \u5b89\u88c5\n$ conda create -n eggnog\n$ conda activate eggnog\n(eggnog)$ conda install eggnog-mapper\n# \u6211\u4eec\u53ea\u5173\u5fc3\u7ec6\u83cc\u548c\u75c5\u6bd2\u7684\u57fa\u56e0\u7ec4\u6ce8\u91ca\uff0c\u56e0\u6b64\u53ea\u4e0b\u8f7d\u8fd92\u4e2a\u6570\u636e\u5e93\n# \u5404\u4e2a\u5355\u72ec\u6570\u636e\u5e93\u53c2\u89c1 http://beta-eggnogdb.embl.de/download/eggnog_4.5/hmmdb_levels\n(eggnog)$ cd PATH/TO/DATA\n(eggnog)$ download_eggnog_data.py -yq --data_dir `pwd` bact\n</code></pre>"},{"location":"book/3.Genome_Annotation/02_eggnog/#_1","title":"\u4f7f\u7528","text":"<p>emapper \u7684\u9ed8\u8ba4\u7b97\u6cd5\u662fhmm\uff0c\u5982\u679c\u60f3\u7528diamond\u6765\u505acluster\uff0c\u9700\u8981\u6dfb\u52a0<code>-m diamond</code>\u53c2\u6570</p> <pre><code># HMM \u6ce8\u91ca\n# \u9488\u5bf9\u7ec6\u83cc\u57fa\u56e0\u7ec4\u6570\u636e\u5e93\uff0c\u4f7f\u752840\u4e2aCPU\u5185\u6838\uff0c\u6570\u636e\u5e93\u8fd0\u884c\u5728\u5185\u5b58\u4e2d\n(eggnog)$ emapper.py -i mygenome.fa -d bact --data_dir PATH/TO/DATA \\\n&gt; --cpus 40 --usemem -o mygenome_bact_result\n# \u9488\u5bf9\u75c5\u6bd2\u57fa\u56e0\u7ec4\u6570\u636e\u5e93\n(eggnog)$ emapper.py -i mygenome.fa -d viruses --data_dir PATH/TO/DATA -o mygenome_virus_result\n# Diamond \u6ce8\u91ca\n(eggnog)$ emapper.py -i mygenome.fa -d bact -m diamond --data_dir PATH/TO/DATA -o mygenome_bact_result\n</code></pre>"},{"location":"book/3.Genome_Annotation/02_eggnog/#_2","title":"\u7ed3\u679c","text":"<p>\u751f\u6210\u7684\u6570\u636e\u6587\u4ef6\u6709\uff1a</p> <ul> <li>*.emapper.hmm_hits</li> <li>*.emapper.seed_orthologs</li> <li>*.emapper.annotations</li> </ul>"},{"location":"book/3.Genome_Annotation/03_snpeff/","title":"snpEFF \u4f7f\u7528","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>snpEFF \u662f\u8bb8\u591a variant calling pipeline \u4e2d\u5e38\u7528\u7684 vcf \u6ce8\u91ca\u5de5\u5177\u3002</p>"},{"location":"book/3.Genome_Annotation/03_snpeff/#_1","title":"\u5b89\u88c5","text":"<pre><code>$ conda install snpEFF\n</code></pre>"},{"location":"book/3.Genome_Annotation/03_snpeff/#_2","title":"\u4f7f\u7528","text":"<pre><code># \u5c06 Listeria monocytogenes \u6d89\u53ca\u7684\u6570\u636e\u5e93\u4e0b\u8f7d\n$ snpEFF databases | awk '/^Listeria_monocytogenes'/ {print $4}' | awk '!a[$1]++{print}' | xargs wget\n</code></pre>"},{"location":"book/4.Genome_Compare/01_mummer/","title":"Mummer","text":"<p>{{ git_page_authors }} \u66f4\u65b0\u4e8e: {{ git_revision_date }}</p> <p>\u5185\u5bb9\u4ecb\u7ecd</p> <p>Mummer \u662f\u4e00\u4e2a\u5386\u53f2\u60a0\u4e45\u7684\u5feb\u901f\u7ec6\u83cc\u57fa\u56e0\u7ec4\u6bd4\u5bf9\u5de5\u5177\uff0c\u901a\u8fc7\u5c0f\u7247\u6bb5<code>MUMs</code>\u6bd4\u5bf9\u5230\u53c2\u8003\u57fa\u56e0\u7ec4\uff0c\u83b7\u5f97\u5e8f\u5217\u7684SNP\u4f4d\u70b9\u5dee\u5f02\u3002\u56e0\u4e3a\u5176\u5feb\u901f\u7684\u7279\u70b9\uff0c\u6709\u8bb8\u591a\u7ec6\u83cc\u5206\u6790\u6d41\u7a0b\u4e2d\u90fd\u6574\u5408\u4e86Mummer\u3002</p> <p>Mummer\u7b97\u6cd5\u662fDeltcher\u63d0\u51fa\u7684\u4e00\u79cd\u57fa\u4e8e\u540e\u7f00\u6811\u6570\u636e\u7ed3\u6784\u7684\u65b9\u6cd5\u3002\u5927\u81f4\u539f\u7406\u662f\u9996\u5148\u8bc6\u522b\u6bd4\u5bf9\u5e8f\u5217\u548c\u53c2\u8003\u5e8f\u5217\u7684\u6700\u5927\u5339\u914d\u7247\u6bb5\uff08Maximal Unique Matches, MUMs\uff09\uff0c\u800c\u8be5\u7247\u6bb5\u5728\u6bd4\u5bf9\u5e8f\u5217\u548c\u53c2\u8003\u5e8f\u5217\u4e2d\u662f\u552f\u4e00\u7684\uff0c\u4e0d\u5305\u542b\u5728\u5176\u4ed6\u66f4\u957fMUMs\u4e2d\u3002\u5bf9MUMs\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u5bf9\u7a7a\u4f4d\u8ba1\u7b97\u3002Mummer\u9002\u5408\u5bf9\u540c\u79cd\u6216\u8fd1\u6e90\u57fa\u56e0\u7ec4\u7684\u5e8f\u5217\u6bd4\u5bf9\uff0c\u5171\u7ebf\u6027\u5206\u6790\uff0cSNPs\u5206\u6790\u7b49\u3002</p>"},{"location":"book/4.Genome_Compare/01_mummer/#mummer323","title":"Mummer3.23","text":"<p>Mummer3.23\u662f2003\u5e74\u53d1\u5e03\u7684\u7248\u672c\uff0c\u4e00\u76f4\u6cbf\u7528\u5230\u4eca\u5929\u3002</p>"},{"location":"book/4.Genome_Compare/01_mummer/#_1","title":"\u5b89\u88c5","text":"<p>conda\u5b89\u88c5</p> <pre><code># \u65b0\u5efa\u865a\u62df\u73af\u5883\n$ conda create -n mummer\n# \u8fdb\u5165\u865a\u62df\u73af\u5883\n$ conda activate mummer\n# \u5b89\u88c5v3.23\u7248\u672c\u7684mummer\n(mummer)$ conda install mummer\n# \u5b89\u88c5gnuplot\uff0cv3\u7248\u672c\u7684mummer\u53ea\u652f\u6301\u8001\u7248\u672c\u7684gnuplot\n(mummer)$ conda install gnuplot=4.6.0\n</code></pre> <p>\u6e90\u4ee3\u7801\u5b89\u88c5</p> <pre><code># \u4e0b\u8f7d\u6e90\u4ee3\u7801\n$ wget http://nchc.dl.sourceforge.net/project/mummer/mummer/3.23/MUMmer3.23.tar.gz\n# \u89e3\u538b\u7f29\n$ tar zxvf MUMmer3.23.tar.gz\n$ cd MUMmer3.23\n# \u7f16\u8bd1\u5b89\u88c5\n$ make install\n$ sudo ln -s `pwd`/bin/* /usr/local/sbin/\n</code></pre> <p>\u6ce8\u610f\uff0c\u7f16\u8bd1\u9700\u8981\u7684\u5de5\u5177\u53ca\u7248\u672c\u3002\u5982\u679c\u7f16\u8bd1\u5931\u8d25\u53ef\u80fd\u662f\u7f3a\u4e4f\u4f9d\u8d56\u5305\u6216\u8005\u7248\u672c\u592a\u65b0\uff1a</p> <ul> <li>make (GNU make 3.79.1)</li> <li>perl (PERL     5.6.0)</li> <li>sh   (GNU sh   1.14.7)</li> <li>csh  (tcsh     6.10.00)</li> <li>g++  (GNU gcc  2.95.3)</li> <li>sed  (GNU sed  3.02)</li> <li>awk  (GNU awk  3.0.4)</li> <li>ar   (GNU ar   2.9.5)</li> <li>fig2dev (fig2dev 3.2.3)</li> <li>gnuplot (gnuplot 4.0)</li> <li>xfig    (xfig    3.2)</li> </ul>"},{"location":"book/4.Genome_Compare/01_mummer/#mummer3","title":"\u4f7f\u7528 Mummer3","text":"<p>\u672c\u8282\u5c06\u4ecb\u7ecd\u6267\u884cmummer\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u4ee5\u53ca\u5404\u4e2a\u7a0b\u5e8f\u7684\u7528\u6cd5\u53ca\u9002\u7528\u9886\u57df\u3002\u5e94\u7528\u7a0b\u5e8f\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u8f6f\u4ef6\u6587\u6863\u3002</p> <p>MUMmer\u8f6f\u4ef6\u5305\u4e2d\u6700\u5e38\u7528\u7684\u4e94\u4e2a\u7a0b\u5e8f\u662f\uff1a</p> <ul> <li>mummer: \u6838\u5fc3\u8ba1\u7b97\u7a0b\u5e8f</li> <li>nucmer: \u6bd4\u5bf9\u6838\u9178\u7684\u6d41\u7a0bperl\u811a\u672c</li> <li>promer: \u6bd4\u5bf9\u6c28\u57fa\u9178\u7684\u6d41\u7a0bperl\u811a\u672c</li> <li>run-mummer1: shell\u5206\u6790\u6d41\u7a0b\u811a\u672c\uff0c</li> <li>run-mummer3: shell\u5206\u6790\u6d41\u7a0b\u811a\u672c\uff0c</li> </ul> <p>\u5176\u4ed6\u529f\u80fd\u7a0b\u5e8f</p> <ul> <li>show-coords: \u5c06 .delta \u6570\u636e\u6587\u4ef6\u751f\u6210 coordinates \u6570\u636e\u8f93\u51fa</li> <li>show-snp</li> <li>show-aligns</li> <li>show-tiling</li> <li>show-diff</li> <li>mgaps: \u5c06MUMs\u805a\u7c7b</li> <li>annotate: \u4e00\u4e2a\u6bd4\u5bf9\u7ed3\u679c\u56fe\u7247\u53ef\u89c6\u5316\u7684\u7edf\u4e00\u8f93\u51fa\u4fee\u6b63\u5de5\u5177</li> <li>combineMUMs:</li> <li>delta-filter</li> <li>dnadiff</li> <li>exact-tandems</li> <li>mapview</li> <li>mummerplot</li> <li>repeat-match</li> </ul> <p>mummer</p> <p>mummer \u662f\u6838\u5fc3\u7b97\u6cd5\u7a0b\u5e8f\u3002\u5176\u4ed6\u7684\u7a0b\u5e8f\u6d41\u7a0b\u8fd0\u884c\u811a\u672c\u3002</p> <p>\u53c2\u6570\uff1a</p> <ul> <li>-mum: \u8ba1\u7b97\u552f\u4e00\u7684\u6700\u5927\u5339\u914d\uff0c\u4e0d\u7ba1\u662f\u5728\u53c2\u8003\u5e8f\u5217\u8fd8\u662f\u6bd4\u5bf9\u5e8f\u5217\u4e2d\u3002</li> <li>-mumcand: \u540c mumreference</li> <li>-mumreference: \u8ba1\u7b97\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e2d\u7684\u6700\u5927\u5339\u914d\uff0c\u4e0d\u8003\u8651\u6bd4\u5bf9\u5e8f\u5217\u552f\u4e00\u6027\uff0c\u8fd9\u662f\u9ed8\u8ba4\u8bbe\u7f6e</li> <li>-maxmatch: \u8ba1\u7b97\u6240\u6709\u6700\u5927\u5339\u914d\uff0c\u4e0d\u8bba\u4ed6\u4eec\u662f\u5426\u662f\u552f\u4e00\u6027\u7684</li> <li>-n: \u8bbe\u7f6e\u5339\u914d\u7684\u5b57\u7b26\uff0c\u9ed8\u8ba4\u662f a/c/g/t\uff0c\u53ef\u4ee5\u662f\u5927\u5199\u548c\u5c0f\u5199</li> <li>-l: \u8bbe\u7f6e\u6700\u5c0f\u5339\u914d\u5e8f\u5217\u957f\u5ea6\uff0c\u9ed8\u8ba4\u662f20</li> <li>-b: \u8ba1\u7b97\u6b63\u4e49\u4e0e\u7ffb\u8bd1\u4e92\u8865\u5339\u914d</li> <li>-r: \u53ea\u8ba1\u7b97\u53cd\u4e49\u4e92\u8865\u5339\u914d</li> <li>-s: \u663e\u793a\u5339\u914d\u7684\u4fe1\u606f</li> <li>-c: \u62a5\u544a\u53cd\u4e49\u4e92\u8865\u5339\u914d\u7684\u6bd4\u5bf9\u5e8f\u5217\u4f4d\u70b9\u4fe1\u606f</li> <li>-F: \u5f3a\u5236\u4f7f\u75284\u5217\u8f93\u51fa\u683c\u5f0f</li> <li>-L: \u5728\u5934\u90e8\u4fe1\u606f\u4e2d\u663e\u793a\u6bd4\u5bf9\u5e8f\u5217\u7684\u957f\u5ea6</li> <li>-h: \u67e5\u770b\u5e2e\u52a9\u4fe1\u606f</li> </ul> <pre><code># \u5c06query.fna\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217ref.fna\n(mummer)$ mummer ref.fna query.fna\n</code></pre> <pre><code># \u6bd4\u8f832\u4e2a\u5b8c\u6210\u57fa\u56e0\u7ec4\n(mummer)$ nucmer\n</code></pre>"},{"location":"book/4.Genome_Compare/01_mummer/#mummer4","title":"Mummer4","text":"<p>\u6ce8\u610f\u4e8b\u9879</p> <p>\u968f\u7740\u65f6\u4ee3\u53d1\u5c55\uff0c\u65b0\u7248\u7684 Mummer4 \u5c1d\u8bd5\u6574\u5408\u4e86\u4e00\u4e9b\u65b0\u529f\u80fd\u548c\u591a\u6838\u6027\u80fd\u7684\u5f00\u653e\uff0c\u4f46\u662f\u76ee\u524d\u8fd8\u5904\u4e8e\u6d4b\u8bd5\u7248\uff0c\u5927\u90e8\u5206\u7684\u7b2c\u4e09\u65b9\u5206\u6790\u6d41\u7a0b\u4e5f\u6ca1\u6709\u66f4\u65b0\u5230 Mummer4\u3002</p>"},{"location":"book/4.Genome_Compare/01_mummer/#_2","title":"\u5b89\u88c5","text":"<p>conda\u5b89\u88c5</p> <pre><code>$ conda create -n mummer4\n$ conda activate mummer4\n(mummer4)$ conda install mummer4\n(mummer4)$ conda install gnuplot=4.6.0\n</code></pre> <p>\u6e90\u4ee3\u7801\u5b89\u88c5</p> <pre><code>$ wget https://github.com/gmarcais/mummer/releases/download/v4.0.0beta/mummer-4.0.0beta2.tar.gz\n$ tar zxf mummer-4.0.0beta2.tar.gz &amp;&amp; cd mummer-4.0.0beta2\n$ ./configure\n$ make &amp;&amp; sudo make install\n$ sudo cp .libs/libumdmummer.so.0.0.0 /lib/x86_64-linux-gnu/\n$ sudo chmod 644 /lib/x86_64-linux-gnu/libumdmummer.so.0.0.0\n$ sudo ln -s /lib/x86_64-linux-gnu/libumdmummer.so.0.0.0 /lib/x86_64-linux-gnu/libumdmummer.so.0\n</code></pre>"},{"location":"book/4.Genome_Compare/01_mummer/#mummer4_1","title":"\u4f7f\u7528Mummer4","text":"<pre><code># \u65b0\u589e\u53c2\u6570 -t \u8868\u793a\u591a\u7ebf\u7a0b\u8ba1\u7b97\n(mummer4)$ nucmer --maxmatch -t 40 -p test ref.fa query.fa\n(mummer4)$ mummerplot -f --postscript --large test.delta\n</code></pre>"},{"location":"book/4.Genome_Compare/01_mummer/#dot","title":"Dot \u5de5\u5177\u505a\u4ea4\u4e92\u53ef\u89c6\u5316","text":"<p>\u7528 mummerplot \u7ed8\u56fe\u662f\u4f7f\u7528gnuplot\u7ed8\u5236\u6210\u5171\u7ebf\u6027\u53ef\u89c6\u5316\u56fe\u3002mummer3 \u6bd4\u8f83\u8001\uff0c\u56e0\u6b64\u4e00\u4e9b\u7248\u672c\u652f\u6301\u4e0a\u4f1a\u6bd4\u8f83\u843d\u540e\u3002\u8fd9\u91cc\u63a8\u8350 Dot \u5de5\u5177\u505a\u4ea4\u4e92\u5f0f\u7684\u53ef\u89c6\u5316\u3002Dot \u5de5\u5177\u662f dnanexus \u5f00\u53d1\u7684\u4e00\u4e2a\u5728\u7ebf\u53ef\u89c6\u5316 nucmer \u8fdb\u884c\u57fa\u56e0\u7ec4\u5171\u7ebf\u6027\u6bd4\u8f83\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5728\u7ebf\u5206\u6790\uff0c\u4e5f\u53ef\u4ee5\u7528\u6d4f\u89c8\u5668\u5728\u672c\u5730\u8fd0\u884c\u3002</p> <pre><code>(mummer)$ git clone https://github.com/dnanexus/dot\n(mummer)$ cd dot\n(mummer)$ python DotPrep.py --delta compare.delta --out compare\n(mummer)$ chromium index.html\n</code></pre> <p>\u4e0a\u4f20 DotPrep.py \u751f\u6210\u7684 compare.coords \u548c compare.coords.idx \u6587\u4ef6\u5230 https://dnanexus.github.io/dot \u6216\u8005\u672c\u5730\u6d4f\u89c8\u5668\u6253\u5f00 index.html \u9875\u9762\uff0c\u70b9\u51fb\u63d0\u4ea4\uff0c\u83b7\u5f97\u53ef\u89c6\u5316\u7ed3\u679c\u3002</p>"},{"location":"book/4.Genome_Compare/01_mummer/#_3","title":"\u53c2\u8003","text":"<ol> <li>\u5982\u4f55\u4f7f\u7528MUMmer\u6bd4\u5bf9\u5927\u7247\u6bb5\u5e8f\u5217</li> </ol>"},{"location":"book/4.Genome_Compare/02_mauve/","title":"Mauve","text":""}]}